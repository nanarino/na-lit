/*! css-doodle v0.42.2 MIT licensed */
(()=>{var e=[":",";",",","(",")","[","]","{","}","\u03c0","\xb1","+","-","*","/","%",'"',"'","`","@","=","^","\xdf","_"],t={escape:e=>"\\"==e,space:e=>/[\r\n\t\s]/.test(e),digit:e=>/^[0-9]$/.test(e),sign:e=>/^[+-]$/.test(e),dot:e=>"."==e,quote:e=>/^["'`]$/.test(e),symbol:t=>e.includes(t),hexNum:e=>/^[0-9a-f]$/i.test(e),hex:(e,r,n)=>"0"==e&&t.letter(r,"x")&&t.hexNum(n),expWithSign:(e,r,n)=>t.letter(e,"e")&&t.sign(r)&&t.digit(n),exp:(e,r)=>t.letter(e,"e")&&t.digit(r),dots:(e,r)=>t.dot(e)&&t.dot(r),letter:(e,t)=>String(e).toLowerCase()==String(t).toLowerCase(),comment:(e,t)=>"/"==e&&"*"==t,inlineComment:(e,t)=>"/"==e&&"/"===t,selfClosedTag:(e,t)=>"/"==e&&">"==t,closedTag:(e,t)=>"<"==e&&"/"==t},r=class{constructor({type:e,value:t,pos:r,status:n}){this.type=e,this.value=t,this.pos=r,n&&(this.status=n)}isSymbol(e){return 0==arguments.length?"Symbol"==this.type:(arguments.length>1&&(e=Array.from(arguments)),Array.isArray(e)?e.some((e=>e===this.value)):e===this.value)}isSpace(){return"Space"==this.type}isNumber(){return"Number"==this.type}isWord(){return"Word"==this.type}};function n(e){let t=-1,r=e.length,n=-1,s=0;return{curr:(r=0)=>e[t+r],next(r=1){let i=e[t+=r];return"\n"===i?(s++,n=0):n+=r,i},end:()=>t>=r,get:()=>({prev:e[t-1],curr:e[t+0],next:e[t+1],next2:e[t+2],next3:e[t+3],pos:[n,s]})}}function s(e){for(;e.next();){let{curr:r,prev:n}=e.get();if(t.comment(r,n))break}}function i(e){for(;e.next()&&"\n"!==e.curr(););}function l(e){return[":",";",",","{","}","(",")","[","]"].includes(e)}function a(e){let r="";for(;!e.end();){let{curr:n,next:s}=e.get();r+=n;let i=t.symbol(s)||t.space(s)||t.digit(s);if(r.length&&i&&!t.closedTag(n,s))break;e.next()}return r.trim()}function o(e){let r="";for(;!e.end();){let{curr:n,next:s}=e.get();if(r+=n,!t.space(s))break;e.next()}return r}function u(e){let r="",n=!1;for(;!e.end();){let{curr:s,next:i,next2:l,next3:a}=e.get();if(r+=s,n&&t.dot(i))break;if(t.dot(s)&&(n=!0),t.dots(i,l))break;if(t.expWithSign(i,l,a))r+=e.next()+e.next();else if(t.exp(i,l))r+=e.next();else if(!t.digit(i)&&!t.dot(i))break;e.next()}return r}function c(e){let r="0x";for(e.next(2);!e.end();){let{curr:n,next:s}=e.get();if(r+=n,!t.hexNum(s))break;e.next()}return r}function h(e){return e[e.length-1]}function p(e,p={}){let f=n(String(e).trim()),d=[],m=[];for(;f.next();){let{prev:e,curr:n,next:g,next2:v,pos:y}=f.get();if(t.comment(n,g))s(f);else if(p.ignoreInlineComment&&t.inlineComment(n,g))i(f);else if(t.hex(n,g,v)){let e=c(f);d.push(new r({type:"Number",value:e,pos:y}))}else if(t.digit(n)||t.digit(g)&&t.dot(n)&&!t.dots(e,n)){let e=u(f);d.push(new r({type:"Number",value:e,pos:y}))}else if(t.symbol(n)&&!t.selfClosedTag(n,g)){let e=h(d),s=t.digit(g)||t.dot(g)&&t.digit(v);if("-"===n&&s&&(!e||!e.isNumber())){let e=u(f);d.push(new r({type:"Number",value:e,pos:y}));continue}let i={type:"Symbol",value:n,pos:y};if(m.length&&t.escape(e.value)){d.pop();let e=a(f);e.length&&d.push(new r({type:"Word",value:e,pos:y}))}else{if(t.quote(n)){h(m)==n?(m.pop(),i.status="close"):(m.push(n),i.status="open")}d.push(new r(i))}}else if(t.space(n)){let e=o(f),t=h(d),{next:s}=f.get();if(!m.length&&t){let r=t.value,i=l(r)&&")"!==r,a=l(s)&&"("!==s;if(i||a)continue;e=p.preserveLineBreak?n:" "}d.length&&s&&s.trim()&&d.push(new r({type:"Space",value:e,pos:y}))}else{let e=a(f);e.length&&d.push(new r({type:"Word",value:e,pos:y}))}}let g=h(d);return g&&g.isSpace()&&(d.length=d.length-1),d}function f(e){let t=[];for(;e.next();){let{curr:r,next:n}=e.get();if("var"===r.value){if(n&&n.isSymbol("(")){e.next();let r=d(e);g(r.name)&&t.push(r)}}else if(t.length&&!r.isSymbol(","))break}return t}function d(e){let t={},r=[];for(;e.next();){let{curr:n,next:s}=e.get();if(n.isSymbol(")",";")&&!t.name){t.name=m(r);break}n.isSymbol(",")?(void 0===t.name&&(t.name=m(r),r=[]),t.name&&(t.fallback=f(e))):r.push(n)}return t}function m(e){return e.map((e=>e.value)).join("")}function g(e){return void 0!==e&&(!(e.length<=2)&&(!e.substr(2).startsWith("-")&&!!e.startsWith("--")))}var v=function(e){return f(n(p(e)))};function y(e,t,r){return e=Number(e)||0,Math.max(t,Math.min(r,e))}function b(e,t){for(let[r,n]of Object.entries(t))e[r]=e[n];return e}function x(e){return/^[a-zA-Z]$/.test(e)}function _(e){return null==e}function $(e){return _(e)||Number.isNaN(e)}function w(e){return _(e)||""===e}function k(e){let t=t=>(...r)=>e(t,...r);return t.lazy=!0,t}function S(e,t,r){return"c-"+e+"-"+t+"-"+r}function j(e){let t=e;for(;t&&!_(t.value);)t=t.value;return t??""}function N(e,t,r=0){let n=new Image;n.crossOrigin="anonymous",n.src=e,n.onload=function(){setTimeout(t,r)}}function E(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function A(e){let t=document.createElement("textarea");return t.innerHTML=e,t.value}function T(e,t=0){e=String(e);let r=3735928559^t,n=1103547991^t;for(let t,s=0;s<e.length;s++)t=e.charCodeAt(s),r=Math.imul(r^t,2654435761),n=Math.imul(n^t,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&n)+(r>>>0)}function R(e,t,r){return t+e*(r-t)}function P(e=""){return e+Math.random().toString(32).substr(2)}function z(e){return _(e)?[]:Array.isArray(e)?e:[e]}function C(e,t="\n"){return(e||[]).join(t)}function M(e,t=1){return _(e)?"":e[e.length-t]}function I(e){return e[0]}var O=function(e,t={symbol:",",noSpace:!1,verbose:!1}){let r=[],s=[],i=[],l=[],a="",o=t.symbol||",",u={},c={},h=[];if(w(e))return r;Array.isArray(o)||(o=[o]),o.forEach((e=>{let[t,r=1/0]=String(e).split(/\s+/);u[t]=0,c[t]=r}));const f=Object.keys(c),d=n(p(e));function m(){h=f.filter((e=>u[e]<c[e]))}function g(e){return t.noSpace?e.isSymbol(h):e.isSymbol(h)||e.isSpace()}function v(e){let n=function(e){return e.map((e=>e.value)).join("")}(e);t.verbose?(a.length||n.length)&&r.push({group:a,value:n}):r.push(n)}for(m();d.next();){let{prev:e,curr:r,next:n}=d.get();r.isSymbol("(")&&i.push(r.value),r.isSymbol(")")&&i.pop(),"open"===r.status&&l.push(r.value),"close"===r.status&&l.pop();let o=!i.length&&!l.length;if(o){let i=t.noSpace&&r.isSpace()&&g(n),l=t.noSpace&&r.isSpace()&&g(e);if(r.isSpace()&&!s.length)continue;if(i||l)continue}if(o&&g(r)){u[r.value]+=1;v(s),a=r.value,s=[],m()}else s.push(r)}return s.length&&v(s),r};function W(e,t){let r,n=[],s=[],i=[],l=!1;for(;e.next();){let{curr:t,next:a}=e.get();t.isSymbol("(")&&!s.length?i.push(t):t.isSymbol(")")&&!s.length&&i.pop(),t.isSymbol("'",'"')&&("open"===t.status?s.push(t):s.pop());let o=!s.length&&!i.length&&(!a||t.isSymbol(";")||a.isSymbol("}"));if(t.isSymbol("'",'"')&&a&&a.isSymbol("}")&&!s.length&&(o=!0),!i.length&&!s.length&&t.isSymbol("{")){let t=q(n);if(!t.length)continue;let s=t.pop(),i=V(...t,s);for(r=X(D(e,Y(s,{type:"block",name:s,value:[]})),i);s=t.pop();)r=X(Y(s,{type:"block",name:s,value:[r]}),i);l=!0;break}if(n.push(t),o)break}return n.length&&!r?(t._valueTokens=n,t.value=B(n)):r&&(t.value=r),l&&(t.value.inline=!0),t.origin&&(t.origin.value=t.value),t}function L(e){let t=[],r=[];for(;e.next();){let{curr:n}=e.get();if(n.isSymbol("{"))t.push(n.value);else if(n.isSymbol("}")){if(!t.length)break;t.pop()}r.push(n.value)}return r.join("")}function D(e,t){let r=[],n=[],s=t&&t.type||"",i=[];for(;e.next();){let{prev:l,curr:a,next:o}=e.get();a.isSymbol("(")&&i.push(a.value),a.isSymbol(")")&&i.pop();let u=!o||a.isSymbol("}");if(G(s)&&u){if(!o&&r.length&&!a.isSymbol("}")){"string"==typeof r[r.length-1].value&&(r[r.length-1].value+=";"+a.value)}t.value=r;break}if(a.isSymbol("{")){let s=q(n);if(!s.length)continue;V(t.name)&&(s=[B(n)]);let i=s.pop(),l=V(...s,t.name,i);if("style"===i)r.push({type:"block",name:i,value:L(e)});else{let t=X(D(e,Y(i,{type:"block",name:i,value:[]})),l);for(;i=s.pop();)t=X(Y(i,{type:"block",name:i,value:[t]}),l);r.push(t)}n=[]}else if(a.isSymbol(":")&&!i.length&&!U(l,o)&&n.length){let i=F(n,(e=>e.isSymbol(","))),l={type:"statement",name:"unkown",value:""};i.length>1&&(l.origin={name:i});let a=W(e,l),o=O(a.value),u=i.length>1&&o.length===i.length;i.forEach(((e,t)=>{let n=Object.assign({},a,{name:e});/^\-\-/.test(e)&&(n.variable=!0),u&&(n.value=o[t]),/viewBox/i.test(e)&&(n.detail=H(n.value,n._valueTokens)),delete n._valueTokens,r.push(n)})),G(s)&&(t.value=r),n=[]}else a.isSymbol(";")?r.length&&n.length&&(r[r.length-1].value+=";"+B(n),n=[]):n.push(a)}return r.length&&G(s)&&(t.value=r),s?t:r}function U(e,t){let r=e&&e.value,n=t&&t.value;return["xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"].includes(r+":"+n)}function B(e){return e.filter(((t,r)=>!t.isSymbol(";","}")||r!==e.length-1)).map((e=>e.value)).join("")}function X(e,t){let r=e.name||"",[n,...s]=r.split(/#/),i=s[s.length-1];return n&&i&&!t&&(e.name=n,e.value.push({type:"statement",name:"id",value:i})),e}function F(e,t){let r=[],n=[];return e.forEach((e=>{t(e)?(r.push(B(n)),n=[]):n.push(e)})),n.length&&r.push(B(n)),r}function q(e){let t,r=[],s=n(e);for(;s.next();){let{prev:e,curr:n,next:i}=s.get(),l=e&&i&&"x"===n.value&&e.isNumber()&&i.isNumber();!n.isWord()||t||l?r[r.length-1]=(r[r.length-1]+n.value).trim():r.push(n.value.trim()),n.isSymbol()?t=!0:n.isSpace()||(t=!1)}return r}function H(e,t){const r={value:[]};let n;if(!Array.isArray(t))return r;for(let e of t)e.isSpace()||e.isSymbol(",",";")||(r.value.length<4&&e.isNumber()?r.value.push(Number(e.value)):e.isNumber()&&n?(r[n]=Number(e.value),n=null):e.isWord()&&(n=e.value));return r}function Y(e,t){let r=Object.assign({},t);if(/\*\s*[0-9]/.test(e)){let[t,n]=e.split("*");n&&(r.times=n.trim(),r.pureName=t.trim())}return r}function V(...e){return e.some((e=>"style"===e))}function G(e){return"block"===e}var Z=function(e,t){return function(e){let t,r=[];for(let n of e.value)"svg"===n.name&&(t=n),n.variable&&r.push(n);if(t&&Array.isArray(t.value)){for(let e of r)t.value.find((t=>t.name==e.name))||t.value.unshift(e);return t}return e}(D(n(p(e)),t||{type:"block",name:"svg",value:[]}))};function K(e,t){let r="";if("block"===e.type){let t=Array.isArray(e.value)&&e.value[0]&&e.value[0].inline;if(e.times?r+="@M"+e.times+"("+e.pureName+"{":r+=e.name+"{","style"===e.name)r+=e.value;else if(Array.isArray(e.value)&&e.value.length){let t="";for(let n of e.value)r+=K(n,t),n.origin&&(t=n.origin.name.join(","))}e.times?r+="})":t||(r+="}")}else if("statement"===e.type){let n=e.origin&&t===e.origin.name.join(","),s=e.origin?e.origin.name.join(","):e.name,i=e.origin?e.origin.value:e.value;n||(r+=i&&i.type?s+":"+K(i):s+":"+i+";")}return r}function J(e){return K(e).trim()}var Q={func:(e="")=>({type:"func",name:e,arguments:[]}),argument:()=>({type:"argument",value:[]}),text:(e="")=>({type:"text",value:e}),pseudo:(e="")=>({type:"pseudo",selector:e,styles:[]}),cond:(e="")=>({type:"cond",name:e,styles:[],arguments:[]}),rule:(e="")=>({type:"rule",property:e,value:[]}),keyframes:(e="")=>({type:"keyframes",name:e,steps:[]}),step:(e="")=>({type:"step",name:e,styles:[]})},ee={white_space:e=>/[\s\n\t]/.test(e),line_break:e=>/\n/.test(e),number:e=>!isNaN(e),pair:e=>['"',"(",")","'"].includes(e),pair_of:(e,t)=>({'"':'"',"'":"'","(":")"}[e]==t),selector(e){let t,r=e.index(),n=[],s=[],i=!1;for(;!e.end();){if(t=e.next(),'"'===t||"'"===t||"`"===t){t===M(s)?s.pop():s.length||s.push(t)}if("("==t&&n.push(t),")"==t&&n.pop(),!n.length&&!s.length){if("{"===t){i=!0;break}if(";"===t||"}"===t){i=!1;break}}}return e.index(r),i}},te={\u03c0:Math.PI,"\u220f":Math.PI};function re(e){return/^@(canvas|shaders|doodle)/.test(e)}function ne(e=""){let t=0,r=1,n=1;return{curr:(r=0)=>e[t+r],end:()=>e.length<=t,info:()=>({index:t,col:r,line:n}),index:e=>void 0===e?t:t=e,range:(t,r)=>e.substring(t,r),next(){let s=e[t++];return"\n"==s?(n++,r=0):r++,s}}}function se(e,{col:t,line:r}){console.warn(`(at line ${r}, column ${t}) ${e}`)}function ie(e,t){return function(r,n){let s=r.index(),i="";for(;!r.end();){let n=r.next();if(e(n)){t&&(i+=n);break}i+=n}return n&&r.index(s),i}}function le(e,t){return ie((e=>/[^\w@]/.test(e)))(e,t)}function ae(e){return ie((e=>/[\s\{]/.test(e)))(e)}function oe(e,t){return ie((e=>ee.line_break(e)||"{"==e),!0)(e,t)}function ue(e,t){let r,n=Q.step();for(;!e.end()&&"}"!=(r=e.curr());)if(ee.white_space(r))e.next();else{if(n.name.length){if(n.styles.push(Se(e,t)),"}"==e.curr())break}else n.name=_e(e,(e=>"{"===e));e.next()}return n}function ce(e,t){const r=[];let n;for(;!e.end()&&"}"!=(n=e.curr());)ee.white_space(n)||r.push(ue(e,t)),e.next();return r}function he(e,t){let r,n=Q.keyframes();for(;!e.end()&&"}"!=(r=e.curr());)if(n.name.length){if("{"==r||"{"==e.curr(-1)){e.next(),n.steps=ce(e,t);break}e.next()}else if(le(e),n.name=ae(e),!n.name.length){se("missing keyframes name",e.info());break}return n}function pe(e,t={}){for(e.next();!e.end();){let r=e.curr();if(t.inline){if("\n"==r)break}else if("*"==(r=e.curr())&&"/"==e.curr(1))break;e.next()}t.inline||(e.next(),e.next())}function fe(e){for(e.next();!e.end();){if(">"==e.curr())break;e.next()}}function de(e){let t,r="";for(;!e.end()&&":"!=(t=e.curr());)ee.white_space(t)||(r+=t),e.next();return r}function me(e,t,r,n={}){let s,i=[],l=[],a=[],o="",u="";for(;!e.end();){s=e.curr();let h=e.curr(-1),p=e.index();if(/[\('"`]/.test(s)&&"\\"!==h)a.length&&"("!==s&&s===M(a)?a.pop():a.push(s),o+=s;else if(!r&&("@"==s||"$"===s||"."===h&&t))l.length||(o=o.trimLeft()),o.length&&(l.push(Q.text(o)),o=""),l.push(xe(e,n));else if(r&&/[)]/.test(s)||!r&&/[,)]/.test(s))if(a.length)")"==s&&"("===M(a)&&a.pop(),o+=s;else{if(o.length&&(l.length?/\S/.test(o)&&l.push(Q.text(o)):l.push(Q.text((c=o).trim().length?ee.number(+c)?+c:c.trim():c)),o.trim().startsWith("\xb1")&&!r)){let e=o.trim().substr(1),t=structuredClone(l);M(t).value="-"+e,i.push(ve(t)),M(l).value=e}if(i.push(ve(l)),[l,o]=[[],""],")"==s)break}else te[s]&&!/[0-9]/.test(e.curr(-1))&&(s=te[s]),o+=s;if(!(!t||")"!=e.curr(1)&&";"!=e.curr(1)&&/[0-9a-zA-Z_\-.]/.test(e.curr())||a.length)){l.length&&i.push(ve(l));break}u+=e.range(p,e.index()+1),e.next()}var c;return[ge(i),u]}function ge(e){let t=M(e[0]);return t&&"text"===t.type&&!String(t.value).trim().length&&(e[0]=e[0].slice(0,-1)),e}function ve(e){let t=e.map((e=>{if("text"==e.type&&"string"==typeof e.value){let t=String(e.value);t.includes("`")&&(e.value=t=t.replace(/`/g,'"')),e.value=t}return e})),r=I(t)||{},n=M(t)||{};if("text"==r.type&&"text"==n.type){let e=I(r.value),s=M(n.value);"string"==typeof r.value&&"string"==typeof n.value&&ee.pair_of(e,s)&&(r.value=r.value.slice(1),n.value=n.value.slice(0,n.value.length-1),t.cluster=!0)}return t}function ye(e){let t=JSON.stringify(e);return t.includes("pureName")&&t.includes("times")}function be(e){return/^@svg$/i.test(e)}function xe(e,t={}){let r,n=Q.func(),s=e.curr(),i=!1,l="$"===s;for("@"===s?e.next():s="@";!e.end();){r=e.curr();let l=e.curr(1),a="."==r&&/[a-zA-Z@$]/.test(l);if("("==r||a){i=!0,e.next();let[r,l]=me(e,a,re(s),t);if(be(s)){let e=Z(l),n=0;for(let r of e.value)r.variable&&(t[r.name]=Te(`${"\n".repeat(n++)} ${r.name}:${r.value}`)[0].value);if(/\d\s*{/.test(l)&&ye(e)){let n=J(e);n+=")",r=me(ne(n),a,re(s),t)[0]}}n.arguments=r,n.variables=t;break}if(/[0-9a-zA-Z_\-.%]/.test(r)&&(s+=r),!i&&"("!==l&&!/[0-9a-zA-Z_\-.%]/.test(l))break;e.next()}let{fname:a,extra:o}=function(e){let t="",r="";if(/\D$/.test(e)&&!/\d+[x-]\d+/.test(e)||Math[e.substr(1)])return{fname:e,extra:r};for(let n=e.length-1;n>=0;n--){let s=e[n],i=e[n-1],l=e[n+1];if(!(/[\d.]/.test(s)||("x"==s||"-"==s)&&/\d/.test(i)&&/\d/.test(l))){t=e.substring(0,n+1);break}r=s+r}return{fname:t,extra:r}}(s);if(n.name=l?"@$"+s.substr(1):a,o.length&&n.arguments.unshift([{type:"text",value:o}]),l&&n.name.length>2){if(!n.arguments.length){let e=n.name.substring(0,2),t=n.name.substring(2);n.name=e,n.arguments.push([{type:"text",value:t}])}if(/\d$/.test(n.name)){let e=n.name.substring(0,2),t=n.name.substring(2);n.name=e,n.arguments[0][0].value=t}}return n.position=e.info().index,n}function _e(e,t=()=>{}){let r,n=Q.text(),s=0,i=!0;const l=[];l[s]=[];let a=[],o=[];for(;!e.end();){if(r=e.curr(),i&&ee.white_space(r)){e.next();continue}if(i=!1,"\n"!=r||ee.white_space(e.curr(-1)))if(","!=r||a.length){if((/[;}<]/.test(r)||t(r))&&!o.length){n.value.length&&(l[s].push(n),n=Q.text());break}if("@"!==r&&"$"!==r||!/[\w-\(%]/.test(e.curr(1)))if('"'===r||"'"===r){r===M(o)?o.pop():o.length||o.push(r),n.value+=r}else ee.white_space(r)&&ee.white_space(e.curr(-1))||("("==r&&a.push(r),")"==r&&a.pop(),te[r]&&!/[0-9]/.test(e.curr(-1))&&(r=te[r]),n.value+=r);else n.value.length&&(l[s].push(n),n=Q.text()),l[s].push(xe(e))}else n.value.length&&(l[s].push(n),n=Q.text()),l[++s]=[],i=!0;else n.value+=" ";let u=e.curr();if((";"===u||"}"==u||t(u))&&!o.length)break;e.next()}return n.value.length&&l[s].push(n),l}function $e(e){let t,r="";for(;!e.end()&&"{"!=(t=e.curr());)r+=t,e.next();return r=r.trim(),r}function we(e){let t,r="",n=[],s={};for(;!e.end()&&!/[){]/.test(t);){if("("==(t=e.curr())){r&&(s.name?n.push({keyword:r}):s.name=r,r=""),e.next();let t=me(e)[0];n.push({arguments:t})}else ee.white_space(t)?ee.white_space(t)&&!s.name?(s.name=r,r=""):ee.white_space(t)&&r.length&&(n.push({keyword:r}),r=""):r+=t;e.next()}let[i,...l]=(s.name||"").trim().split(/\s+/);return s.name=i,s.addition=l,s.segments=n,s}function ke(e,t){let r,n=Q.pseudo();for(;!e.end();){if(r=e.curr(),"/"==r&&"*"==e.curr(1))pe(e);else{if("}"==r)break;if(ee.white_space(r)){e.next();continue}if(n.selector){let r=Se(e,t);if("@use"==r.property?n.styles=n.styles.concat(r.value):r.property&&n.styles.push(r),"}"==e.curr())break}else n.selector=$e(e)}e.next()}return n}function Se(e,t){let r,n=Q.rule(),s=e.index();for(;!e.end();){if(r=e.curr(),"/"==r&&"*"==e.curr(1))pe(e);else{if(";"==r)break;if(n.property.length){n.value=_e(e);break}if(n.property=de(e),"@use"==n.property){n.value=Ae(e,t);break}}e.next()}let i=e.index();return n.raw=()=>e.range(s,i).trim(),n}function je(e,t){let r,n=Q.cond();for(;!e.end();){if(r=e.curr(),"/"==r&&"*"==e.curr(1))pe(e);else{if("}"==r)break;if(n.name.length)if(":"==r){let t=ke(e);t.selector&&n.styles.push(t)}else if("@"!=r||oe(e,!0).includes(":")){if(!ee.white_space(r)){let r=Se(e,t);if(r.property&&n.styles.push(r),"}"==e.curr())break}}else n.styles.push(je(e));else Object.assign(n,we(e))}e.next()}return n}function Ne(e,t){let r="";return e&&e.get_variable&&(r=e.get_variable(t)),r}function Ee(e,t){e.forEach&&e.forEach((e=>{if("text"==e.type&&e.value){let r=v(e.value);e.value=r.reduce(((e,r)=>{let n,s="",i="";s=Ne(t,r.name),!s&&r.fallback&&r.fallback.every((e=>{if(i=Ne(t,e.name),i)return s=i,!1}));try{n=Te(s,t)}catch(e){}return n&&e.push.apply(e,n),e}),[])}"func"==e.type&&e.arguments&&e.arguments.forEach((e=>{Ee(e,t)}))}))}function Ae(e,t){return e.next(),(_e(e)||[]).reduce(((e,r)=>{Ee(r,t);let[n]=r;return n.value&&n.value.length&&e.push(...n.value),e}),[])}function Te(e,t){const r=ne(e),n=[];for(;!r.end();){let e=r.curr();if(ee.white_space(e))r.next();else{if("/"==e&&"*"==r.curr(1))pe(r);else if(":"==e){let e=ke(r,t);e.selector&&n.push(e)}else if("@"==e&&"@keyframes"===le(r,!0)){let e=he(r,t);n.push(e)}else if("<"==e)fe(r);else if(ee.selector(r)){let e=je(r,t);e.name.length&&n.push(e)}else if(!ee.white_space(e)){let e=Se(r,t);e.property&&n.push(e)}r.next()}}return n}function Re(e,t=64){const[r,n,s]=[1,t,t*t];let[i,l,a]=(e+"").replace(/\s+/g,"").replace(/[,\uff0cxX]+/g,"x").split("x").map((e=>parseInt(e)));const o=1==i||1==l?s:n,u=1==i&&1==l?s:r,c={x:y(i||r,1,o),y:y(l||i||r,1,o),z:y(a||r,1,u)};return Object.assign({},c,{count:c.x*c.y*c.z,ratio:c.x/c.y})}function Pe(e){return/^texture\w*$|^(fragment|vertex)$/.test(e)}function ze(){return new r({type:"LineBreak",value:"\n"})}function Ce(e){let t=e[0],r=e[e.length-1];for(;t&&t.isSymbol("(")&&r&&r.isSymbol(")");)t=(e=e.slice(1,e.length-1))[0],r=e[e.length-1];return e}function Me(e){return Ce(e).map((e=>e.value)).join("")}var Ie=function(e){let t,r,s=n(Ce(p(e,{preserveLineBreak:!0,ignoreInlineComment:!0}))),i=[],l=[],a={textures:[]};for(;s.next();){let{curr:e,next:n}=s.get();if(e.isSymbol("{")){if(i.length)l.push(e);else{let r=Me(l);Pe(r)?(t=r,l=[]):l.push(e)}i.push("{")}else if(e.isSymbol("}"))if(i.pop(),!i.length&&t){let e=Me(l);t&&e.length&&(t.startsWith("texture")?a.textures.push({name:t,value:e}):a[t]=e,l=[]),t=null}else l.push(e);else w(r)||r==e.pos[1]||(l.push(ze()),r=null),t&&t.startsWith("texture")||e.isWord()&&e.value.startsWith("#")&&(l.push(ze()),r=n.pos[1]),l.push(e)}return w(a.fragment)&&(a.fragment=Me(l),a.textures=a.textures||[]),a};var Oe=function(e){let t=n(p(e)),r={},s={commands:[],valid:!0};for(;t.next();){let{curr:e}=t.get();if(!e.isSpace()&&!e.isSymbol(","))if(e.isWord())r.name&&(s.commands.push(r),r={}),r.name=e.value,r.value=[],"MmLlHhVvCcSsQqTtAaZz".includes(e.value)?"mlhvcsqtaz".includes(e.value)?r.type="relative":r.type="absolute":(r.type="unknown",s.valid=!1);else if(r.value){let t=e.value;e.isNumber()&&(t=Number(e.value)),r.value.push(t)}else r.name||(s.valid=!1)}return r.name&&s.commands.push(r),s};var We=function(e){let t=n(p(e)),r={},s=!1;for(;t.next();){let{prev:e,curr:n,next:i}=t.get(),l=s&&(n.isWord()||n.isSymbol())&&e&&e.isNumber()&&!i;if(n.isNumber())r.value=Number(n.value),s=!0;else{if(!l)break;r.unit=n.value}}return r},Le='xmlns="http://www.w3.org/2000/svg"',De='xmlns="http://www.w3.org/1999/xhtml"',Ue='xmlns:xlink="http://www.w3.org/1999/xlink"';function Be(e,t){return`url("data:image/svg+xml;utf8,${encodeURIComponent(e)+(t?`#${t}`:"")}")`}function Xe(e){return e.includes("<svg")||(e=`<svg ${Le} ${Ue}>${e}</svg>`),e.includes("xmlns")||(e=e.replace(/<svg([\s>])/,`<svg ${Le} ${Ue}$1`)),e}var Fe=function(){let e=0;return(t="")=>`${t}-${++e}`}(),qe=class{constructor(e,t=""){if(!e)throw new Error("Tag name is required");this.id=Symbol(),this.name=e,this.body=[],this.attrs={},this.isTextNode()&&(this.body=t)}isTextNode(){return"text-node"===this.name}find(e){let t=e.attrs.id,r=e.name;if(Array.isArray(this.body)&&void 0!==t)return this.body.find((e=>e.attrs.id===t&&e.name===r))}findSpareDefs(){return this.body.find((e=>"defs"===e.name&&!e.attrs.id))}append(e){Array.isArray(e)||(e=[e]);for(let t of e)this.isTextNode()||this.body.push(t)}merge(e){for(let[t,r]of Object.entries(e.attrs))this.attrs[t]=r;Array.isArray(e.body)&&this.body.push(...e.body)}attr(e,t){if(!this.isTextNode())return void 0===t?this.attrs[e]:this.attrs[e]=t}toString(){if(this.isTextNode())return He(this.body);let e=[""],t=[];for(let[t,r]of Object.entries(this.attrs))r=He(r),e.push(`${t}="${r}"`);for(let e of this.body)t.push(e.toString());return t.join("").length||/svg/i.test(this.name)?`<${this.name}${e.join(" ")}>${t.join("")}</${this.name}>`:`<${this.name}${e.join(" ")}/>`}};function He(e){let t=(e=String(e)).startsWith('"')&&e.endsWith('"'),r=e.startsWith("'")&&e.endsWith("'");return t||r?e.substring(1,e.length-1):e}function Ye(e,t,r,n){let s;if(t||(t=new qe("root")),"block"===e.type)if("style"===e.name){let r=new qe("style");r.append(e.value),t.append(r)}else{let i=new qe(e.name);if(n||(n=i).attr("xmlns",Le.split("=")[1]),"defs"===e.name){let e=n.findSpareDefs();e&&(i=e)}for(let t of e.value){e.parent=r;let l=Ye(t,i,e,n);l&&(s=l)}let l=e&&e.inline&&"defs"!==e.name,a=r&&r.inline&&"defs"===r.name,o=a&&1==r.value.length;if(l||a){let t=e.value.find((e=>"statement"===e.type&&"id"===e.name));t?s=t.value:(o||l)&&(s=Fe(e.name),i.attr("id",s))}let u=t.find(i);if(u)u.merge(i);else if("defs"===e.name){let e=n.findSpareDefs();e&&!i.attrs.id?i.id!==e.id&&e.append(i.body):n.append(i)}else t.append(i)}if("statement"===e.type&&!e.variable)if("content"===e.name){let r=new qe("text-node",e.value);t.append(r)}else if(e.name.startsWith("style ")){let r=(e.name.split("style ")[1]||"").trim();if(r.length){let n=t.attr("style")||"";t.attr("style",n+function(e,t){return`${e}:${t};`}(r,e.value))}}else{let s=e.value;if(s&&"block"===s.type){let t=Ye(e.value,n,e,n);_(t)?s="":(s=`url(#${t})`,"xlink:href"!==e.name&&"href"!==e.name||(s=`#${t}`))}if(/viewBox/i.test(e.name))s=function(e){let t=e.detail.value,r=e.detail.padding||e.detail.p||e.detail.expand;if(!t.length)return"";let[n,s,i,l]=t;return r&&([n,s,i,l]=[n-r,s-r,i+2*r,l+2*r]),`${n} ${s} ${i} ${l}`}(e),s&&t.attr(e.name,s);else if("draw"!==e.name&&"animate"!==e.name||"path"!==(i=r&&r.name)&&"line"!==i&&"circle"!==i&&"ellipse"!==i&&"rect"!==i&&"polygon"!==i&&"polyline"!==i)t.attr(e.name,s);else{let[e,r]=String(s).split(/\s+/);("indefinite"===e||"infinite"===e||/\d$/.test(e))&&([e,r]=[r,e]),"infinite"===r&&(r="indefinite"),t.attr("stroke-dasharray",10),t.attr("pathLength",10);let n=new qe("animate");n.attr("attributeName","stroke-dashoffset"),n.attr("from",10),n.attr("to",0),n.attr("dur",e),r&&n.attr("repeatCount",r),t.append(n)}e.name.includes("xlink:")&&n.attr("xmlns:xlink",Ue.split("=")[1])}var i;return r?s:n.toString()}function Ve(e){return Ye(e)}var Ge=["auto","reverse"],Ze=["deg","rad","grad","turn"];var Ke=function(e){let t=n(p(e)),r=!1,s="",i={direction:"",angle:""};for(;t.next();){let{prev:e,curr:n,next:l}=t.get();if(n.isWord()&&Ge.includes(n.value))i.direction=n.value,r=!0;else if(n.isNumber())i.angle=Number(n.value),r=!0;else if(n.isWord()&&e&&e.isNumber()&&Ze.includes(n.value))s=n.value;else if(n.isSpace()&&""!==i.direction&&""!==i.angle)break}return r||(i.direction="auto"),function(e,t){let{angle:r}=e;""===r&&(r=0);"rad"===t&&(r/=Math.PI/180);"grad"===t&&(r*=.9);"turn"===t&&(r*=360);return Object.assign({},e,{angle:r})}(i,s)};function Je(e,t,r){return["fill-rule","fill"].includes(e)?t:r?`-1 * (${t})`:t}function Qe(e){return e.map((e=>e.value)).join("")}var et=function(e){let t,r=n(p(e)),s={},i=[],l=!1;for(;r.next();){let{prev:e,curr:n,next:a}=r.get();if(n.isSymbol(":")&&!t)t=Qe(i),i=[];else if(n.isSymbol(";")&&t)s[t]=Je(t,Qe(i),l),i=[],t=null,l=!1;else if(!n.isSymbol(";")){let r=e&&e.isSymbol("-"),s=a&&a.isSymbol("-"),o=n.isSymbol("-");t||i.length||!o||r||s||a&&a.isSymbol(":")?i.push(n):l=!0}}return i.length&&t&&(s[t]=Je(t,Qe(i),l)),s},tt=new class{constructor(){this.cache=new Map}clear(){this.cache.clear()}set(e,t){if(_(e))return"";let r=this.getKey(e);return this.cache.set(r,t),t}has(e){return this.cache.has(e)}get(e){let t=this.getKey(e);return this.cache.get(t)}getKey(e){return _(e)?"":T("string"==typeof e?e:JSON.stringify(e))}};function rt(e,t){return(...r)=>{let n=e+r.join("-");return tt.get(n)||tt.set(n,t(...r))}}var nt={\u03c0:Math.PI,gcd:(e,t)=>{for(;t;)[e,t]=[t,e%t];return e}},st={"^":7,"*":6,"/":6,"\xf7":6,"%":6,"&":5,"|":5,"+":4,"-":4,"<":3,"<<":3,">":3,">>":3,"=":3,"==":3,"\u2264":3,"<=":3,"\u2265":3,">=":3,"\u2260":3,"!=":3,"\u2227":2,"&&":2,"\u2228":2,"||":2,"(":1,")":1};function it(e,t,r=[]){let n=[];for(;e.length;){let{name:s,value:i,type:l}=e.shift();if("variable"===l){let e=t[i];$(e)&&(e=Math[i]),$(e)&&(e=ot(i,t,r)),$(e)&&/^\-\D/.test(i)&&(e=ot("-1"+i.substr(1),t,r)),void 0===e&&(e=0),"number"!=typeof e&&(r.push(e),ut(r)?(e=0,r=[]):e=it(lt(e),t,r)),n.push(e)}else if("function"===l){let e=!1;/^\-/.test(s)&&(e=!0,s=s.substr(1));let l,a=i.map((e=>it(e,t,r))),o=s.split(".");for(;l=o.pop();){if(!l)continue;let e=t[l]||Math[l];a="function"==typeof e?Array.isArray(a)?e(...a):e(a):0}e&&(a*=-1),n.push(a)}else if(/\d+/.test(i))n.push(i);else{let e=n.pop(),t=n.pop();n.push(at(i,Number(t),Number(e)))}}return Number(n[0])||0}function lt(e){let t=function(e){if(tt.has(e))return tt.get(e);let t=String(e),r=[],n="";for(let e=0;e<t.length;++e){let s=t[e];if(st[s]){let i=M(r);if("="==s&&i&&/^[!<>=]$/.test(i.value))i.value+=s;else if(/^[|&<>]$/.test(s)&&i&&i.value==s)i.value+=s;else if("-"==s&&"e"==t[e-1])n+=s;else if(r.length||n.length||!/[+-]/.test(s)){let{type:e,value:t}=i||{};"operator"==e&&!n.length&&/[^()]/.test(s)&&/[^()]/.test(t)?n+=s:(n.length&&(r.push({type:"number",value:n}),n=""),r.push({type:"operator",value:s}))}else n+=s}else/\S/.test(s)&&(","==s?(r.push({type:"number",value:n}),n="",r.push({type:"comma",value:s})):"!"==s?(r.push({type:"number",value:n}),r.push({type:"operator",value:s}),n=""):n+=s)}return n.length&&r.push({type:"number",value:n}),tt.set(e,r),r}(e);const r=[],n=[];for(let e=0;e<t.length;++e){let{type:s,value:i}=t[e],l=t[e+1]||{};if("number"==s)if("("==l.value&&/[^\d.\-]/.test(i)){let r="",s=[],l=[];for(e+=1;void 0!==t[e++];){let n=t[e];if(void 0===n)break;let i=n.value;if(")"==i){if(!s.length)break;s.pop(),r+=i}else if("("==i&&s.push(i),","!=i||s.length)r+=i;else{let e=lt(r);e.length&&l.push(e),r=""}}r.length&&l.push(lt(r)),n.push({type:"function",name:i,value:l})}else/[^\d.\-]/.test(i)?n.push({type:"variable",value:i}):n.push({type:"number",value:i});else if("operator"==s)if("("==i)r.push(i);else if(")"==i){for(;r.length&&"("!=M(r);)n.push({type:"operator",value:r.pop()});r.pop()}else{for(;r.length&&st[M(r)]>=st[i];){let e=r.pop();/[()]/.test(e)||n.push({type:"operator",value:e})}r.push(i)}}for(;r.length;)n.push({type:"operator",value:r.pop()});return n}function at(e,t,r){switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"%":return t%r;case"|":return t|r;case"&":return t&r;case"<":return t<r;case">":return t>r;case"^":return Math.pow(t,r);case"\xf7":case"/":return t/r;case"=":case"==":return t==r;case"\u2264":case"<=":return t<=r;case"\u2265":case">=":return t>=r;case"\u2260":case"!=":return t!=r;case"\u2227":case"&&":return t&&r;case"\u2228":case"||":return t||r;case"<<":return t<<r;case">>":return t>>r}}function ot(e,t,r){let[n,s,i]=e.match(/([\d.\-]+)(.*)/)||[],l=t[i];return void 0===l?l:"number"==typeof l?Number(s)*l:(r.push(l),ut(r)?(r=[],0):s*it(lt(l),t,r))}function ut(e){if(e.length>50)return!0;let t=M(e);for(let r=2;r<=4;++r){let n=e[e.length-r];if(void 0===n)return!1;if(t!==n)return!1}return!0}function ct(e,t){return it(lt(e),Object.assign({},nt,t))}var{cos:ht,sin:pt,abs:ft,atan2:dt,PI:mt}=Math,gt={circle:"\n split:180;scale:.99\n ",triangle:"\n rotate:30;scale:1.1;move:0 .2\n ",pentagon:"\n split:5;rotate:54\n ",hexagon:"\n split:6;rotate:30;scale:.98\n ",octagon:"\n split:8;rotat:22.5;scale:.99\n ",star:"\n split:10;r:cos(5t);rotate:-18;scale:.99\n ",infinity:"\n split:180;scale:.99;x:cos(t)*.99 / (sin(t)^2 + 1);y:x * sin(t)\n ",heart:"\n split:180;rotate:180;a:cos(t)*13/18 - cos(2t)*5/18;b:cos(3t)/18 + cos(4t)/18;x:(.75 * sin(t)^3) * 1.2;y:(a - b + .2) * -1.1\n ",bean:"\n split:180;r:sin(t)^3 + cos(t)^3;move:-.35 .35;",bicorn:"\n split:180;x:cos(t);y:sin(t)^2 / (2 + sin(t)) - .5\n ",drop:"\n split:180;rotate:90;scale:.95;x:sin(t);y:(1 + sin(t)) * cos(t) / 1.6\n ",fish:"\n split:240;x:cos(t) - sin(t)^2 / sqrt(2) - .04;y:sin(2t)/2\n ",whale:"\n split:240;rotate:180;R:3.4 * (sin(t)^2 - .5) * cos(t);x:cos(t) * R + .75;y:sin(t) * R * 1.2\n ",windmill:"\n split:18;R:seq(.618, 1, 0);T:seq(t-.55, t, t);x:R * cos(T);y:R * sin(T)\n ",vase:"\n split:240;scale:.3;x:sin(4t) + sin(t) * 1.4;y:cos(t) + cos(t) * 4.8 + .3\n ",clover:(e=3)=>(4==(e=y(e,3,5))&&(e=2),`\n split:240;r:cos(${e}t);scale:.98\n`),hypocycloid:(e=3)=>`\n split:240;scale:${[.34,.25,.19][(e=y(e,3,5))-3]};k:${e};x:(k-1)*cos(t) + cos((k-1)*t);y:(k-1)*sin(t) - sin((k-1)*t)\n`,bud:(e=3)=>`\n split:240;scale:.8;r:1 + .2 * cos(${e=y(e,3,10)}t)\n`},vt=class{constructor(e,t,r){this.x=e,this.y=t,this.extra=r}valueOf(){return this.x+" "+this.y}toString(){return this.valueOf()}};function yt(e,t){t||(t=e=>[ht(e),pt(e)]);let r,n,s=e.split||180,i=e.turn||1,l=e.frame,a=e.fill||e["fill-rule"],o=Ke(e.direction||e.dir||""),u=e.unit,c=2*mt*i/s,h=[],p=void 0===e.scale?1:e.scale,f=([e,t,r=0,n=0])=>{if("evenodd"==e||"nonzero"==e)return h.push(new vt(e,"",""));let[s,i]=bt(e,-t,p),[l,a]=bt(r,-n,p),c=function(e,t,r,n,s){let i=180*dt(t+n,e-r)/mt;"reverse"===s.direction&&(i-=180);s.direction||(i=90);s.angle&&(i+=s.angle);return i}(s,i,l,a,o);void 0!==u&&"%"!==u?"none"!==u&&(s+=u,i+=u):(s=50*(s+1)+"%",i=50*(i+1)+"%"),h.push(new vt(s,i,c))};"nonzero"!=a&&"evenodd"!=a||f([a,"",""]);for(let e=0;e<s;++e){let n=t(c*e,e);e||(r=n),f(n)}if(void 0!==l){f(r);let e=l/100;i>1&&(e*=2),0==e&&(e=.002);for(let r=0;r<s;++r){let s=-c*r,[i,l,a=0,o=0]=t(s,r),u=dt(l+o,i-a),h=[i-e*ht(u),l-e*pt(u)];r||(n=h),f(h)}f(n),f(r)}return h}function bt(e,t,r){let[n,s=n]=O(r).map(Number);return[e*n,t*s]}function xt(e,{min:t,max:r}){let n=y(parseInt(e.vertices||e.points||e.split)||0,t,r),s=w(e.x)?"cos(t)":e.x,i=w(e.y)?"sin(t)":e.y,l=w(e.r)?"":e.r,a=w(e.t)?"":e.t,{unit:o,value:u}=We(l);return o&&!e[o]&&"t"!==o&&(w(e.unit)&&(e.unit=o),l=e.r=u),e.degree&&(e.rotate=e.degree),e.origin&&(e.move=e.origin),e.split=n,yt(e,((t,r)=>{let o=Object.assign({},e,{t:a||t,\u03b8:a||t,i:r+1,seq:(...e)=>e.length?e[r%e.length]:"",range:(e,t=0)=>((e=Number(e)||0)>(t=Number(t)||0)&&([e,t]=[t,e]),e+ft(t-e)/(n-1)*r)}),u=ct(s,o),c=ct(i,o),h=0,p=0;if(l){let e=ct(l,o);0==e&&(e=1e-5),a&&(t=ct(a,o)),u=e*ht(t),c=e*pt(t)}return e.rotate&&([u,c]=function(e,t,r){let n=-mt/180*r;return[e*ht(n)-t*pt(n),t*ht(n)+e*pt(n)]}(u,c,Number(e.rotate)||0)),e.move&&([u,c,h,p]=function(e,t,r){let[n,s=n]=O(r).map(Number);return[e+(n||0),t-(s||0),n,s]}(u,c,e.move)),[u,c,h,p]}))}function _t(e,t=3,r=3600,n){let s="",[i,...l]=O(e),a=!1;switch(typeof gt[i]){case"function":s=gt[i](...l),a=!0;break;case"string":s=gt[i],a=!0;break;default:s=e}let o=et(s);return"function"==typeof n&&(o=n(o)),{rules:o,points:xt(o,{min:t,max:r}),preset:a}}var $t=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];function wt(e,t,r){return t+e*(r-t)}function kt(e,t,r,n){let s=15&e,i=s<8?t:r,l=s<4?r:12==s||14==s?t:n;return(1&s?-i:i)+(2&s?-l:l)}var St=class{constructor(){this.p=[].concat($t,$t)}noise(e,t,r){let{p:n}=this,[s,i,l]=[e,t,r].map((e=>255&Math.floor(e)));[e,t,r]=[e,t,r].map((e=>e-Math.floor(e)));let[a,o,u]=[e,t,r].map((e=>e*e*e*(e*(6*e-15)+10))),c=n[s]+i,h=n[c]+l,p=n[c+1]+l,f=n[s+1]+i,d=n[f]+l,m=n[f+1]+l;return wt(u,wt(o,wt(a,kt(n[h],e,t,r),kt(n[d],e-1,t,r)),wt(a,kt(n[p],e,t-1,r),kt(n[m],e-1,t-1,r))),wt(o,wt(a,kt(n[h+1],e,t,r-1),kt(n[d+1],e-1,t,r-1)),wt(a,kt(n[p+1],e,t-1,r-1),kt(n[m+1],e-1,t-1,r-1))))}};function jt(e){let t=864e5,r=`${e}-animation`;return{name:e,ticks:t,"animation-name":r,animation:(e="0s")=>`86400000ms steps(10368000) ${e} infinite ${r}`}}var Nt=jt("cssd-utime"),Et=jt("cssd-UTime"),At="cssd-umousex",Tt="cssd-umousey",Rt="cssd-uwidth",Pt="cssd-uheight";function zt(e){return(...t)=>{let r=[],n=[];for(let e of t){let{unit:t,value:s}=We(e);void 0!==t&&r.push(t),void 0!==s&&n.push(s)}let s=e(...n),i=r.find((e=>void 0!==e));return void 0===i?s:Array.isArray(s)?s.map((e=>e+i)):s+i}}function Ct(e){return(...t)=>{let r=t.map((e=>String(e).charCodeAt(0))),n=e(...r);return Array.isArray(n)?n.map((e=>String.fromCharCode(e))):String.fromCharCode(n)}}function Mt(e,t){return{type:e,value:t}}function It(e,t,r){let n=0,s=e,i=e=>e>0&&e<1?.1:1,l=arguments.length;1==l&&([e,t]=[i(e),e]),l<3&&(r=i(e));let a=[];for(;(r>=0&&e<=t||r<0&&e>t)&&(a.push(e),e+=r,!(n++>=65535)););return a.length||a.push(s),a}var Ot=rt("build_range",(e=>{let t=function(e){let t=String(e),r=[],n=[];if(!t.startsWith("[")||!t.endsWith("]"))return r;for(let e=1;e<t.length-1;++e){let s=t[e];if("-"!=s||"-"!=t[e-1])if("-"!=s)if("-"!=M(n))n.length&&r.push(Mt("char",n.pop())),n.push(s);else{n.pop();let e=n.pop();r.push(e?Mt("range",[e,s]):Mt("char",s))}else n.push(s)}return n.length&&r.push(Mt("char",n.pop())),r}(e);return t.flatMap((({type:e,value:t})=>{if("char"==e)return t;let[r,n]=t,s=!1;r>n&&([r,n]=[n,r],s=!0);let i=Ct(It)(r,n);return s&&i.reverse(),i}))}));function Wt(e){return(...t)=>e(...t.flatMap((e=>String(e).startsWith("[")?Ot(e):e)))}var Lt=class{constructor(e){this.prev=this.next=null,this.data=e}},Dt=class{constructor(e=20){this._limit=e,this._size=0}push(e){this._size>=this._limit&&(this.root=this.root.next,this.root.prev=null);let t=new Lt(e);this.root?(t.prev=this.tail,this.tail.next=t,this.tail=t):this.root=this.tail=t,this._size++}last(e=1){let t=this.tail;for(;--e&&t.prev;)t=t.prev;return t.data}};function Ut(e,t){let r={},n=!0;for(let s=0;s<e.length;++s){let i=e[s],l=t[s];if(/=/.test(i)){let[e,s]=O(i,{symbol:"=",noSpace:!0});void 0!==s?(t.includes(e)&&(r[e]=s),n=!1):r[l]=i}else n&&(r[l]=i)}return r}function Bt(e){return k(((t,r,...n)=>{if(!n||!r)return"";let s=j(r()),i=s;/\D/.test(s)&&!/\d+[x-]\d+/.test(s)&&(i=ct(s),0===i&&(i=s));let l=Math.random();return function(e,t){let[r,n=1]=String(e).split(/[x-]/),[s,i]=[Math.ceil(r),Math.ceil(n)];$(s)&&(s=1),$(i)&&(i=1),r=y(s,0,65536),n=y(i,0,65536);let l=r*n,a=[],o=1;if(/x/.test(e))for(let e=1;e<=n;++e)for(let s=1;s<=r;++s)a.push(t(o,s,e,l,r,n,o)),o++;else if(/-/.test(e))if(l=Math.abs(r-n)+1,r<=n)for(let e=r;e<=n;++e)a.push(t(e,e,1,l,l,1,o++));else for(let e=r;e>=n;--e)a.push(t(e,e,1,l,l,1,o++));else for(let e=1;e<=r;++e)a.push(t(e,e,1,r,r,1,o++));return a}(i,((...e)=>n.map((t=>j(t(...e,l)))).join(","))).join(e)}))}function Xt(e,t,r){return e[t]||(e[t]=new Dt(1024)),e[t].push(r),r}function Ft(e){return-1*e}function qt(e,t,r){switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r;case"%":return t%r;default:return 0}}function Ht(e,t){return[`calc(${e})`,t]}function Yt(e,t){if(w(t)||w(e))return[];if(/^[\+\*\-\/%][\-\.\d\s]/.test(t)){let r=t[0],{unit:n="",value:s}=We(t.substr(1).trim()||0);return/var\(/.test(e)?Ht("%"===r?`mod(${e}, ${s})`:`${e} ${r} ${s}`,n):[qt(r,Number(e),Number(s)),n]}if(/[\+\*\-\/%]$/.test(t)){let r=t.substr(-1),{unit:n="",value:s}=We(t.substr(0,t.length-1).trim()||0);return/var\(/.test(e)?Ht("%"===r?`mod(${s}, ${e})`:`${s} ${r} ${e}`,n):[qt(r,Number(s),Number(e)),n]}{let{unit:r="",value:n}=We(t||0);return[Number(e)+Number(n),r]}}function Vt(e){let t="";return(...r)=>{for(let n of r){let[r,s]=Yt(e,n);e=r,!t&&s&&(t=s)}return/^calc\(/.test(e)?`calc(${e} * 1${t})`:e+t}}var Gt=b({i:({count:e})=>Vt(e),y:({y:e})=>Vt(e),x:({x:e})=>Vt(e),z:({z:e})=>Vt(e),I:({grid:e})=>Vt(e.count),Y:({grid:e})=>Vt(e.y),X:({grid:e})=>Vt(e.x),Z:({grid:e})=>Vt(e.z),iI:({count:e,grid:t})=>Vt(e/t.count),Ii:({count:e,grid:t})=>Vt((t.count-e+1)/t.count),xX:({x:e,grid:t})=>Vt(e/t.x),Xx:({x:e,grid:t})=>Vt((t.x-e+1)/t.x),yY:({y:e,grid:t})=>Vt(e/t.y),Yy:({y:e,grid:t})=>Vt((t.y-e+1)/t.y),id:({x:e,y:t,z:r})=>n=>S(e,t,r),dx:({x:e,grid:t})=>r=>(r=Number(r)||0,e-.5-r-t.x/2),dy:({y:e,grid:t})=>r=>(r=Number(r)||0,e-.5-r-t.y/2),n({extra:e}){let t=M(e);return t?Vt(t[0]):"@n"},nx({extra:e}){let t=M(e);return t?Vt(t[1]):"@nx"},ny({extra:e}){let t=M(e);return t?Vt(t[2]):"@ny"},nd({extra:e}){let t=M(e);if(t){let e=t[0],r=t[3];return t=>(t=Number(t)||0,e-.5-t-r/2)}return"@nd"},N({extra:e}){let t=M(e);return t?Vt(t[3]):"@N"},nN({extra:e}){let t=M(e);return t?Vt(t[0]/t[3]):"@nN"},Nn({extra:e}){let t=M(e);if(t){let e=t[0],r=t[3];return Vt((r-e+1)/r)}return"@Nn"},m:Bt(","),M:Bt(" "),\u00b5:Bt(""),p:({context:e,pick:t})=>Wt(((...r)=>{r.length||(r=e.last_pick_args||[]);let n=t(r);return e.last_pick_args=r,Xt(e,"last_pick",n)})),P({context:e,pick:t,position:r}){let n="P-counter"+r;return Wt(((...r)=>{let s=!0;r.length||(r=e.last_pick_args||[],s=!1);let i=e.last_pick,l=i?i.last(1):"";if(s&&(e[n]||(e[n]={}),l=e[n].last_pick),r.length>1){let e=r.findIndex((e=>e===l));-1!==e&&r.splice(e,1)}let a=t(r);return e.last_pick_args=r,s&&(e[n].last_pick=a),Xt(e,"last_pick",a)}))},pl({context:e,extra:t,upextra:r,position:n},s){let i=M(s&&r.length?r:t),l=(s?"PL-counter":"pl-counter")+n+(i?M(i):"");return Wt(((...t)=>{e[l]||(e[l]=0),e[l]+=1;let r=t.length,n=i&&i[6];n??=e[l];let s=t[(n-1)%r];return Xt(e,"last_pick",s)}))},PL:e=>Gt.pl(e,!0),pr({context:e,extra:t,upextra:r,position:n},s){let i=M(s&&r.length?r:t),l=(s?"PR-counter":"pr-counter")+n+(i?M(i):"");return Wt(((...t)=>{e[l]||(e[l]=0),e[l]+=1;let r=t.length,n=i&&i[6];n??=e[l];let s=t[r-(n-1)%r-1];return Xt(e,"last_pick",s)}))},PR:e=>Gt.pr(e,!0),pd({context:e,extra:t,upextra:r,position:n,shuffle:s},i){let l=M(i&&r.length?r:t),a=l?M(l):"",o=(i?"PD-counter":"pd-counter")+n+a,u=(i?"PD-valeus":"pd-values")+n+a;return Wt(((...t)=>{e[o]||(e[o]=0),e[o]+=1,e[u]||(e[u]=s(t||[]));let r=t.length,n=l&&l[6];n??=e[o];let i=(n-1)%r,a=e[u][i];return Xt(e,"last_pick",a)}))},PD:e=>Gt.pd(e,!0),lp:({context:e})=>(t=1)=>{let r=e.last_pick;return r?r.last(t):""},r:({context:e,rand:t})=>(...r)=>{let n=(r.length&&r.every(x)?Ct:zt)(t)(...r);return Xt(e,"last_rand",n)},rn({x:e,y:t,context:r,position:n,grid:s,extra:i,random:l}){let a="noise-2d"+n,o=a+"offset-x",u=a+"offset-y",[c,h,p,f,d,m]=M(i)||[],g=c&&f;return(...n)=>{let{from:i=0,to:c=i,frequency:f=1,scale:v=1,octave:b=1}=Ut(n,["from","to","frequency","scale","octave"]);f=y(f,0,1/0),v=y(v,0,1/0),b=y(b,1,100),1==n.length&&([i,c]=[0,i]),r[a]||(r[a]=new St),r[o]||(r[o]=l()),r[u]||(r[u]=l());let _=x(i)&&x(c)?Ct:zt,$=r[a],w=r[o],k=r[u],S=(g?(h-1)/d:(e-1)/s.x)+w,j=(g?(p-1)/m:(t-1)/s.y)+k;(d<=1||s.x<=1)&&(S=0),(m<=1||s.y<=1)&&(j=0),0==S&&0==j&&(S=w,j=k);let N=$.noise(S*f,j*f,0)*v;for(let e=1;e<b;++e){let t=2*e;N+=$.noise(S*f*t,j*f*t,0)*(v/t)}let E=_(((e,t)=>function(e,t,r,n=1){let s=Math.sqrt(.5)*n,[i,l]=[-s,s];return R((e-i)/(l-i),t*n,r*n)}(N,e,t,v)));return Xt(r,"last_rand",E(i,c))}},lr:({context:e})=>(t=1)=>{let r=e.last_rand;return r?r.last(t):""},stripe:()=>(...e)=>{let t,r=e.map(j),n=r.length,s=0,i=[];if(!n)return"";r.forEach((e=>{let[t,r]=O(e);void 0!==r?i.push(r):s+=1}));let l=i.length?`(100% - ${i.join(" - ")}) / ${s}`:`100% / ${n}`;return r.map(((e,r)=>{if(i.length){let[r,n]=O(e);return t=(t?t+" + ":"")+(void 0!==n?n:l),`${r} 0 calc(${t})`}return`${e} 0 ${100/n*(r+1)}%`})).join(",")},calc:()=>(e,t)=>ct(j(e),t),hex:()=>e=>parseInt(j(e)).toString(16),svg:k(((e,...t)=>{let r=t.map((e=>j(e()))).join(",");if(!r.startsWith("<")){r=Ve(Z(r))}return Be(Xe(r))})),"svg-filter":k(((e,...t)=>{let r=t.map((e=>j(e()))),n=r.join(","),s=P("filter-");if(r.every((e=>/^[\-\d.]/.test(e)||/^(\w+)/.test(e)&&!/[{}<>]/.test(e)))){let{frequency:t,scale:s,octave:i,seed:l=e.seed,blur:a,erode:o,dilate:u}=Ut(r,["frequency","scale","octave","seed","blur","erode","dilate"]);if(n="\n x:-20%;y:-20%;width:140%;height:140%;",_(u)||(n+=`\n feMorphology{operator:dilate;radius:${u};}`),_(o)||(n+=`\n feMorphology{operator:erode;radius:${o};}`),_(a)||(n+=`\n feGaussianBlur{stdDeviation:${a};}`),!_(t)){let[e,r=e]=O(t);i=i?`numOctaves:${i};`:"",n+=`\n feTurbulence{type:fractalNoise;baseFrequency:${e} ${r};seed:${l};${i}}`,s&&(n+=`\n feDisplacementMap{in:SourceGraphic;scale:${s};}`)}}if(!n.startsWith("<")){n=Ve(Z(n,{type:"block",name:"filter"}))}return Be(Xe(n).replace(/<filter([\s>])/,`<filter id="${s}"$1`),s)})),"svg-pattern":k(((e,...t)=>{let r=t.map((e=>j(e()))).join(",");return Be(Ve(Z(`\n viewBox:0 0 1 1;preserveAspectRatio:xMidYMid slice;rect{width, height:100%;fill:defs pattern{${r}}}`)))})),"svg-polygon":k(((e,...t)=>{let r=t.map((e=>j(e()))).join(","),{rules:n,points:s}=_t(r,3,65536,(e=>(delete e.frame,e.unit="none",e["stroke-width"]??=.01,e.stroke??="currentColor",e.fill??="none",e))),i=`points:${s};`,l="",a=n.padding??Number(n["stroke-width"])/2;for(let e of Object.keys(n))/^(stroke|fill|clip|marker|mask|animate|draw)/.test(e)&&(l+=`${e}:${n[e]};`);return Be(Ve(Z(`\n viewBox:-1 -1 2 2 p ${a};polygon{${l} ${i}}`)))})),var:()=>e=>`var(${j(e)})`,ut:()=>Vt(`var(--${Nt.name})`),ts:()=>Vt(`calc(var(--${Nt.name}) / 1000)`),TS:()=>Vt(`calc(var(--${Et.name}) / 1000)`),UT:()=>Vt(`var(--${Et.name})`),uw:()=>Vt(`var(--${Rt})`),uh:()=>Vt(`var(--${Pt})`),ux:()=>Vt(`var(--${At})`),uy:()=>Vt(`var(--${Tt})`),plot({count:e,context:t,extra:r,position:n,grid:s}){let i=M(r);return(...t)=>{let r=t.join(","),[n=e,l,a,o=s.count]=i||[],{points:u,rules:c}=_t(r,1,65536,(e=>(delete e.fill,delete e["fill-rule"],delete e.frame,e.split||e.points?e.hasPoints=!0:e.points=o,e)));return c.hasPoints?u:u[n-1]}},Plot({count:e,context:t,extra:r,position:n,grid:s}){let i=M(r);return(...t)=>{let r=t.join(","),[n=e,l,a,o=s.count]=i||[],{points:u,rules:c}=_t(r,1,65536,(e=>(delete e.fill,delete e["fill-rule"],delete e.frame,e.split||e.points?e.hasPoints=!0:e.points=o,e.unit=e.unit||"none",e)));return c.hasPoints?u:u[n-1]}},shape:()=>rt("shape-function",((...e)=>{let t=e.join(","),{points:r}=_t(t);return`polygon(${r.join(",")})`})),doodle:()=>e=>e,shaders:()=>e=>e,pattern:()=>e=>e,invert:()=>e=>{let t=Oe(e);return t.valid?t.commands.map((({name:e,value:t})=>{switch(e){case"v":return"h"+t.join(" ");case"V":return"H"+t.join(" ");case"h":return"v"+t.join(" ");case"H":return"V"+t.join(" ");default:return e+t.join(" ")}})).join(" "):e},flipH:()=>e=>{let t=Oe(e);return t.valid?t.commands.map((({name:e,value:t})=>{switch(e){case"h":case"H":return e+t.map(Ft).join(" ");default:return e+t.join(" ")}})).join(" "):e},flipV:()=>e=>{let t=Oe(e);return t.valid?t.commands.map((({name:e,value:t})=>{switch(e){case"v":case"V":return e+t.map(Ft).join(" ");default:return e+t.join(" ")}})).join(" "):e},flip(...e){let t=Gt.flipH(...e),r=Gt.flipV(...e);return e=>r(t(e))},reverse:()=>(...e)=>{let t=e.map(j),r=Oe(t.join(","));if(r.valid){let e=[];for(let t=r.commands.length-1;t>=0;--t){let{name:n,value:s}=r.commands[t];e.push(n+s.join(" "))}return e.join(" ")}return t.reverse()},cycle:()=>(...e)=>{let t,r=[];1==(e=e.map((e=>"<"+e+">"))).length?(t=" ",r=O(e[0],{symbol:t})):(t=",",r=O(e.map(j).join(t),{symbol:t})),r=r.map((e=>e.replace(/^\<|>$/g,"")));let n=r.length-1,s=[r.join(t)];for(let e=0;e<n;++e){let e=r.shift();r.push(e),s.push(r.join(t))}return s},mirror:()=>(...e)=>{for(let t=e.length-1;t>=0;--t)e.push(e[t]);return e},Mirror:()=>(...e)=>{for(let t=e.length-2;t>=0;--t)e.push(e[t]);return e},code:()=>(...e)=>e.map((e=>String.fromCharCode(e))),once:k((({context:e,extra:t,position:r},...n)=>{let s="once-counter"+r;return e[s]??=n.map((e=>j(e()))).join(",")})),raw:({rules:e})=>(t="")=>{try{let r=t.substring(t.indexOf(",")+1,t.lastIndexOf('")'));if(t.startsWith("${doodle")&&t.endsWith("}")){let r=t.substring(2,t.length-1),n=e.doodles;if(n&&n[r])return`<css-doodle>${n[r].doodle}</css-doodle>`}if(t.startsWith('url("data:image/svg+xml;utf8'))return decodeURIComponent(r);if(t.startsWith('url("data:image/svg+xml;base64'))return atob(r);if(t.startsWith('url("data:image/png;base64'))return`<img src="${t}" alt="" />`}catch(e){}return t}},{index:"i",col:"x",row:"y",depth:"z",rand:"r",pick:"p",pn:"pl",pnr:"pr",PN:"PL",PNR:"PR",R:"rn",T:"UT",t:"ut",stripes:"stripe",strip:"stripe",patern:"pattern",flipv:"flipV",fliph:"flipH",filter:"svg-filter","last-rand":"lr","last-pick":"lp",multiple:"m",multi:"m",rep:"\xb5",repeat:"\xb5",ms:"M",s:"I",size:"I",sx:"X","size-x":"X","size-col":"X","max-col":"X",sy:"Y","size-y":"Y","size-row":"Y","max-row":"Y",sz:"Z","size-z":"Z","size-depth":"Z",Svg:"svg","pick-by-turn":"pl","pick-n":"pl","pick-d":"pd",offset:"plot",Offset:"Plot",point:"plot",Point:"Plot",unicode:"code"}),Zt=Gt,Kt={a0:[841,1189],a1:[594,841],a2:[420,594],a3:[297,420],a4:[210,297],a5:[148,210],a6:[105,148],b0:[1e3,1414],b1:[707,1e3],b2:[500,707],b3:[353,500],b4:[250,353],b5:[176,250],b6:[125,176],c0:[917,1297],c1:[648,917],c2:[458,648],c3:[324,458],c4:[229,324],c5:[162,229],d0:[764,1064],d1:[532,760],d2:[380,528],d3:[264,376],d4:[188,260],d5:[130,184],d6:[92,126],letter:[216,279],postcard:[100,148],poster:[390,540]},Jt={portrait:"p",pt:"p",p:"p",landscape:"l",ls:"l",l:"l"};var Qt="--_cell-width",er="--_cell-height",tr={center:"50%",left:"0%",right:"100%",top:"50%",bottom:"50%"},rr={center:"50%",top:"0%",bottom:"100%",left:"50%",right:"50%"},nr=b({size(e,{is_special_selector:t,grid:r}){let[n,s=n,i]=O(e);Kt[n]&&([n,s]=function(e,t){e=String(e).toLowerCase();let[r,n]=Kt[e]??[];return"p"==Jt[t]&&([n,r]=[r,n]),[n,r].map((e=>e+"mm"))}(n,s));let l=`width:${n};height:${s};`;return"auto"!==n&&"auto"!==s||(i&&(/^\(.+\)$/.test(i)?i=i.substring(1,i.length-1):/^calc/.test(i)||(i=`calc(${i})`),t||(l+=`aspect-ratio:${i};`)),t&&(l+=`aspect-ratio:${i||r.ratio};`)),t||(l+=`${Qt}:${n};${er}:${s};`),l},place(e,{extra:t}){let[r,n="50%"]=O(e);r=tr[r]||r,n=rr[n]||n;let s=`var(${Qt}, 25%)`,i=`var(${er}, 25%)`;return`\n position:absolute;left:${r};top:${n};width:${s};height:${i};margin-left:calc(${s} / -2);margin-top:calc(${i} / -2);grid-area:unset;--plot-angle:${t||0};rotate:${t||0}deg;`},grid(e,t){let r={clip:!0,p3d:!1},n=[],s=0;for(let i of O(e,{symbol:" "}))0!==s||"|"!==i&&"-"!==i?/^no\-*clip$/i.test(i)?(r.clip=!1,n.push("\xa7")):/^p3d$/i.test(i)?(r.p3d=!0,n.push("\xa7")):(r.grid||(r.grid=Re(i,t.max_grid)),n.push(i)):(r.flex="|"===i?"column":"row",n.push("\xa7")),s+=1;let i=O(n.join(" "),{symbol:["/ 2","+","^","*","~","\u2206","_","\xdf","\xa7"],noSpace:!0,verbose:!0});for(let{group:e,value:n}of i){if("+"===e&&(r.scale=n),"^"===e&&(r.enlarge=n),"~"===e&&(r.translate=n),"\u2206"===e&&(r.persp=O(n,{symbol:" "})),"_"===e&&(r.gap=n),"*"===e){let[e,...t]=O(n,{symbol:" "});"h"==e?r.hueRotate=t.join(" "):r.rotate=n}if("/"===e&&(void 0===r.size?r.size=this.size(n,t):r.fill=n),"\xdf"===e){let e=O(n,{symbol:" "});for(let t=0;t<e.length;t++)if(Number(e[t])){e[t]+="px";break}1===e.length&&/^\D/.test(e[0])&&!/^\.\d/.test(e[0])&&e.push("1px"),/solid|dotted|dashed|double|groove|ridge|inset|outset/.test(n)||e.push("solid"),r.border=e.join(" ")}""!==e||r.grid||(r.grid=Re(n,t.max_grid))}return r},gap:e=>e,seed:e=>e,shape:rt("shape-property",(e=>{let{points:t,preset:r}=_t(e);return r?`clip-path:polygon(${t.join(",")});`:""})),use(e){if(e.length>2)return e},content:e=>e},{"place-cell":"place",offset:"place",position:"place"});function sr(e,t){return"+"===t?e:"-"===t?-1*e:e}function ir(e){return e.reduce(((e,t)=>e+t),0)}function lr(e){return e%2}function ar(e){return!lr(e)}function or(e){let t="";return t=0==e?"$:hover":e>0?`$:hover ${"+*".repeat(e)}`:`:has(+ ${"*+".repeat(Math.abs(e+1))} $:hover)`,t}function ur(e,t,r,s){if("even"===e)return{value:lr(r+s)};if("odd"===e)return{value:ar(r+s)};if("n"===e)return{value:!0};let{a:i,b:l,error:a}=function(e){let t,r,s=n(p(e)),i=[],l=[];for(;s.next();){let{prev:e,curr:n,next:a}=s.get(),o=n.value;if(n.isSymbol()){if("+"!==o&&"-"!==o){r="Unexpected "+n.value;break}t=o}else if(n.isNumber()){if((i.length||l.length)&&!t){r="Syntax error";break}if(o=sr(Number(o),t),t=null,a&&"n"===a.value){i.push(o),s.next();continue}l.push(o)}else if("n"===o){if((i.length||l.length)&&!t){r="Syntax error";break}i.push(sr(1,t)),t=null}else if(!n.isSpace()){r="Unexpected "+o;break}}return r?{a:0,b:0,error:r}:{a:ir(i),b:ir(l)}}(e);if(a)return{value:!1,error:a};if(0===i)return{value:t===l};{let e=(t-l)/i;return{value:e>=0&&Number.isInteger(e)}}}var cr,hr=b({at:({x:e,y:t})=>(r,n)=>e==r&&t==n,nth:({count:e,grid:t})=>(...t)=>{for(let r of t)if(ur(r,e).value)return!0},y:({y:e,grid:t})=>(...t)=>{for(let r of t)if(ur(r,e).value)return!0},x:({x:e,grid:t})=>(...t)=>{for(let r of t)if(ur(r,e).value)return!0},even:({x:e,y:t})=>r=>lr(e+t),odd:({x:e,y:t})=>r=>ar(e+t),random:({random:e,count:t,x:r,y:n,grid:s})=>(i=.5)=>/\D/.test(i)?e()<ct("("+i+")",{x:r,X:s.x,y:n,Y:s.y,i:t,I:s.count,random:e}):e()<i,match:({count:e,grid:t,x:r,y:n,random:s})=>i=>!!ct("("+i+")",{x:r,X:t.x,y:n,Y:t.y,i:e,I:t.count,random:s}),cell:({count:e,grid:t,x:r,y:n,random:s})=>(...i)=>{if(!i.length)return!0;return i.map((i=>{let{value:l,error:a}=ur(i,e,r,n);return a?!!ct("("+i+")",{x:r,X:t.x,y:n,Y:t.y,i:e,I:t.count,random:s}):l})).some(Boolean)},hover:({count:e,x:t,y:r,grid:n,random:s})=>(...e)=>{let s=[];e.length||s.push(or(0));for(let i of e){let[e,l]=String(i).split(/\s+/);if(e=Number(e),l=Number(l),Number.isNaN(l)&&!Number.isNaN(e)&&s.push(or(e)),!Number.isNaN(e)&&!Number.isNaN(l)){let i=e+t,a=l+r;if(i>=1&&i<=n.x&&a>=1&&a<=n.y){let t=l*n.y+e;s.push(or(t))}}}return!!s.length&&{selector:s.join(",")}}},{col:"x",row:"y"}),pr=globalThis,fr=Math,dr=[],mr=256,gr=fr.pow(mr,6),vr=fr.pow(2,52),yr=2*vr,br=mr-1;function xr(e){var t,r=e.length,n=this,s=0,i=n.i=n.j=0,l=n.S=[];for(r||(e=[r++]);s<mr;)l[s]=s++;for(s=0;s<mr;s++)l[s]=l[i=br&i+e[s%r]+(t=l[s])],l[i]=t;(n.g=function(e){for(var t,r=0,s=n.i,i=n.j,l=n.S;e--;)t=l[s=br&s+1],r=r*mr+l[br&(l[s]=l[i=br&i+t])+(l[i]=t)];return n.i=s,n.j=i,r})(mr)}function _r(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function $r(e,t){var r,n=[],s=typeof e;if(t&&"object"==s)for(r in e)try{n.push($r(e[r],t-1))}catch(e){}return n.length?n:"string"==s?e:e+"\0"}function wr(e,t){for(var r,n=e+"",s=0;s<n.length;)t[br&s]=br&(r^=19*t[br&s])+n.charCodeAt(s++);return kr(t)}function kr(e){return String.fromCharCode.apply(0,e)}wr(fr.random(),dr);var Sr=function(e,t,r){var n=[],s=wr($r((t=1==t?{entropy:!0}:t||{}).entropy?[e,kr(dr)]:null==e?function(){try{var e;return cr&&(e=cr.randomBytes)?e=e(mr):(e=new Uint8Array(mr),(pr.crypto||pr.msCrypto).getRandomValues(e)),kr(e)}catch(e){var t=pr.navigator,r=t&&t.plugins;return[+new Date,pr,r,pr.screen,kr(dr)]}}():e,3),n),i=new xr(n),l=function(){for(var e=i.g(6),t=gr,r=0;e<vr;)e=(e+r)*mr,t*=mr,r=i.g(1);for(;e>=yr;)e/=2,t/=2,r>>>=1;return(e+r)/t};return l.int32=function(){return 0|i.g(4)},l.quick=function(){return i.g(4)/4294967296},l.double=l,wr(kr(i.S),dr),(t.pass||r||function(e,t,r,n){return n&&(n.S&&_r(n,i),e.state=function(){return _r(i,{})}),r?(fr.random=e,t):e})(l,s,"global"in t?t.global:this==fr,t.state)},jr=(new Date).setHours(0,0,0,0)-Date.now();function Nr(e){return/^\:(host|doodle)/.test(e)}function Er(e){return/^\:container/.test(e)}function Ar(e){return Nr(e)||Er(e)}var Tr={};for(let e of Object.getOwnPropertyNames(Math))Tr[e]=()=>(...t)=>"number"==typeof Math[e]?Math[e]:(t=t.map((e=>ct(j(e)))),Math[e](...t));var Rr=class{constructor(e){this.tokens=e,this.rules={},this.props={},this.keyframes={},this.grid=null,this.seed=null,this.is_grid_set=!1,this.is_gap_set=!1,this.coords=[],this.doodles={},this.pattern={},this.shaders={},this.vars={},this.uniforms={},this.content={},this.reset()}reset(){this.styles={host:"",container:"",cells:"",keyframes:""},this.coords=[],this.doodles={},this.pattern={},this.shaders={},this.content={},this.vars={};for(let e in this.rules)e.startsWith("#c")&&delete this.rules[e]}add_rule(e,t){let r=this.rules[e];r||(r=this.rules[e]=[]),r.push.apply(r,z(t))}pick_func(e){return e.startsWith("$")&&(e="calc"),Zt[e]||Tr[e]}apply_func(e,t,r,n,s={}){let i=e(...z(t)),l=[];if(r.forEach((e=>{let t=typeof e.value;if(e.cluster||"number"!==t&&"string"!==t){if("function"==typeof e)l.push(e);else if(!_(e.value)){let t=j(e.value);l.push(t)}}else l.push(...O(e.value,{noSpace:!0}))})),l=z(l.filter((e=>!_(e)&&String(e).trim().length))),"function"==typeof i){if(n.startsWith("$")){let e=Object.assign({},this.vars.host,this.vars.container,this.vars[t.count],s),r={},a="";for(let[t,n]of Object.entries(e))r[t.substr(2)]=n;return n.length>1&&(a=n.split("$")[1]??""),i(l,r)+a}return i(...l)}return i}compose_aname(...e){return e.join("-")}compose_selector({x:e,y:t,z:r},n=""){return`#${S(e,t,r)}${n}`}is_composable(e){return["doodle","shaders","pattern"].includes(e)}read_var(e,t,r){let n=t.count,s=Object.assign({},this.vars.host,this.vars.container,this.vars[n],r);if(void 0!==s[e]){let t=String(s[e]).trim();if("("==t[0]){")"===t[t.length-1]&&(t=t.substring(1,t.length-1))}return t.replace(/;+$/g,"")}return e}compose_argument(e,t,r=[],n,s){t.extra||(t.extra=[]),t.extra.push(r);let i=e.map((e=>{if("text"===e.type)return/^\-\-\w/.test(e.value)?n&&"@var"===n.name?e.value:this.read_var(e.value,t,s):e.value;if("func"===e.type){let n=e.name.substr(1),i=this.pick_func(n);if("function"==typeof i){if(this.check_uniforms(n),this.is_composable(n)){let r,s=j((e.arguments[0]||[])[0]);if("doodle"===n&&/^\d/.test(s)&&(r=s,s=j((e.arguments[1]||[])[0])),!_(s))switch(n){case"doodle":return this.compose_doodle(this.inject_variables(s,t.count),r,structuredClone(t.extra));case"shaders":return this.compose_shaders(s,t);case"pattern":return this.compose_pattern(s,t)}}t.position=e.position;let l=e.arguments.map((n=>i.lazy?(...r)=>this.compose_argument(n,t,r,e,s):this.compose_argument(n,t,r,e,s)));return this.apply_func(i,t,l,n,s)}return e.name}}));return t.extra.pop(),{cluster:e.cluster,value:i.length>=2?{value:i.join("")}:i[0]}}compose_doodle(e,t,r){let n=P("doodle");return this.doodles[n]={doodle:e,arg:t,upextra:r},"${"+n+"}"}compose_shaders(e,{x:t,y:r,z:n}){let s=P("shader");return this.shaders[s]={shader:e,id:"--"+s,cell:S(t,r,n)},"${"+s+"}"}compose_pattern(e,{x:t,y:r,z:n}){let s=P("pattern");return this.pattern[s]={code:e,id:"--"+s,cell:S(t,r,n)},"${"+s+"}"}check_uniforms(e){switch(e){case"ut":case"UT":case"t":case"T":case"ts":case"TS":this.uniforms.time=!0;break;case"ux":this.uniforms.mousex=!0;break;case"uy":this.uniforms.mousey=!0;break;case"uw":this.uniforms.width=!0;break;case"uh":this.uniforms.height=!0}}inject_variables(e,t){let r=Object.assign({},this.vars.host,this.vars.container,this.vars[t]),n=[];for(let[e,t]of Object.entries(r))n.push(`${e}:${t};`);return n=n.join(""),n.length?`:doodle{${n}}`+e:e}compose_variables(e,t,r={}){for(let[n,s]of Object.entries(e))r[n]=this.get_composed_value(s,t,r).value;return r}compose_value(e,t,r={}){if(!Array.isArray(e))return{value:"",extra:""};let n="";return{value:e.reduce(((e,s)=>{switch(s.type){case"text":e+=s.value;break;case"func":{let i=s.name.substr(1),l=this.pick_func(i);if("function"==typeof l)if(this.check_uniforms(i),this.is_composable(i)){let r,n=j((s.arguments[0]||[])[0]);if("doodle"===i&&/^\d/.test(n)&&(r=n,n=j((s.arguments[1]||[])[0])),!_(n))switch(i){case"doodle":e+=this.compose_doodle(this.inject_variables(n,t.count),r,structuredClone(t.extra));break;case"shaders":e+=this.compose_shaders(n,t);break;case"pattern":e+=this.compose_pattern(n,t)}}else{t.position=s.position,s.variables&&this.compose_variables(s.variables,t,r);let a=s.arguments.map((e=>l.lazy?(...n)=>this.compose_argument(e,t,n,s,r):this.compose_argument(e,t,[],s,r))),o=this.apply_func(l,t,a,i,r);_(o)||(e+=o,o.extra&&(n=o.extra))}else e+=s.name}}return e}),""),extra:n}}get_composed_value(e,t,r){let n,s=[];return Array.isArray(e)&&(s=e.reduce(((e,s)=>{let i=this.compose_value(s,t,r||{});return i&&(i.value&&e.push(i.value),i.extra&&(n=i.extra)),e}),[])),{extra:n,group:s,value:s.join(",")}}add_grid_style({fill:e,clip:t,rotate:r,hueRotate:n,scale:s,translate:i,enlarge:l,skew:a,persp:o,flex:u,p3d:c,border:h,gap:p}){if(e&&this.add_rule(":host",`background:${e};`),t||this.add_rule(":host","contain:none;"),r&&(/[0-9]$/.test(r)&&(r+="deg"),this.add_rule(":container",`rotate:${r};`)),n&&(/[0-9]$/.test(n)&&(n+="deg"),this.add_rule(":host",`filter:hue-rotate(${n});`)),s&&this.add_rule(":container",`scale:${s};`),i&&this.add_rule(":container",`translate:${i};`),o){let[e,...t]=o;this.add_rule(":host",`perspective:${e};`),t.length&&this.add_rule(":host",`perspective-origin:${t.join(" ")};`)}if(l&&this.add_rule(":container",`\n width:calc(${l} * 100%);height:calc(${l} * 100%);left:50%;top:50%;transform-origin:0 0;transform:translate(-50%, -50%);`),u&&(this.add_rule(":container","display:flex;"),this.add_rule("cell","flex:1;"),"column"===u&&this.add_rule(":container","flex-direction:column;")),c){let e="transform-style:preserve-3d;";this.add_rule(":host",e),this.add_rule(":container",e)}void 0!==h&&this.add_rule(":host",`border:${h};`),p&&this.add_rule(":container",`gap:${p};`)}compose_rule(e,t,r){let n=Object.assign({},t),s=e.property;if("@seed"===s)return"";let i=this.get_composed_value(e.value,n),l=i.extra,a=i.value;if(/^animation(\-name)?$/.test(s)){if(this.props.has_animation=!0,Nr(r)){let e=Nt.n+","+Et.n;e&&a&&(a=e+","+a)}if(n.count>1){let{count:e}=n;switch(s){case"animation-name":a=i.group.map((t=>this.compose_aname(t,e))).join(",");break;case"animation":a=i.group.map((t=>{let r=(t||"").split(/\s+/);return r[0]=this.compose_aname(r[0],e),r.join(" ")})).join(",")}}}if("content"===s){/["']|^none\s?$|^(var|counter|counters|attr|url)\(/.test(a)||(a=`'${a}'`);let e=new Map;return a=a.replace(/var\(\-\-cssd\-u(time|mousex|mousey|width|height)\)/gi,((t,r)=>(e.set(r,`${r} calc(${t})`),`counter(${r})`))),`\n ${e.size?`counter-reset:${Array.from(e.values()).join(" ")};`:""} content:${a};`}"transition"===s&&(this.props.has_transition=!0);let o=`${s}:${a};`;if("width"!==s&&"height"!==s||Ar(r)||(o+=`--_cell-${s}:${a};`),/^background(\-image)?$/.test(s)&&/\$\{(shader|pattern)/.test(a)&&(o+="background-size:100% 100%;"),/^\-\-/.test(s)&&this.compose_vars(t,r,s,a),/^@/.test(s)&&nr[s.substr(1)]){let t=s.substr(1),i=nr[t](a,{is_special_selector:Ar(r),grid:n.grid,max_grid:n.max_grid,extra:l});switch(t){case"grid":Nr(r)?(o=i.size||"",this.add_grid_style(i)):(o="",this.is_grid_set||(i=nr[t](a,{is_special_selector:!0,grid:n.grid,max_grid:n.max_grid}),this.add_rule(":host",i.size||""),this.add_grid_style(i))),this.grid=n.grid,this.is_grid_set=!0;break;case"gap":o="",this.is_gap_set||(this.add_rule(":container",`gap:${i};`),this.is_gap_set=!0);break;case"content":{o="";let e=this.compose_selector(n);void 0===i||/\:before|\:after/.test(r)||Er(r)||(this.content[e]=function(e){if(e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"))return e.substring(1,e.length-1);return e}(String(i))),this.content[e]=Zt.raw({rules:{doodles:this.doodles}})(this.content[e]||"")}case"seed":o="";break;case"place-cell":case"place":case"position":case"offset":Nr(r)||(o=i);break;case"use":e.value.length&&this.compose(n,e.value),o="";break;default:o=i}}return/^grid/.test(s)&&Nr(r)&&(this.add_rule(":container",`${s}:${a};`),o=""),o}get_raw_value(e){let t=e.raw()??"",[r,...n]=t.split(e.property);return n=n.join(e.property).replace(/^\s*:\s*/,"").replace(/[;}<]$/,"").trim().replace(/[;}<]$/,""),n}compose_vars(e,t,r,n){let s=e.count;Er(t)&&(s="container"),Nr(t)&&(s="host"),this.vars[s]||(this.vars[s]={}),this.vars[s][r]=n}pre_compose_rule(e,t,r){let n=Object.assign({},t),s=e.property,i=Object.assign({},this.vars.host,this.vars.container,this.vars[n.count]);if(/^\-\-/.test(s)){let l=this.get_composed_value(e.value,n,i).value;this.compose_vars(t,r,s,l)}switch(s){case"@grid":{let r=this.get_composed_value(e.value,n,i).value,l=s.substr(1),a=nr[l](r,{max_grid:t.max_grid});this.grid=a.grid;break}case"@use":e.value.length&&this.pre_compose(n,e.value)}}pre_compose(e,t){_(this.seed)&&((t||this.tokens).forEach((e=>{if("rule"===e.type&&"@seed"===e.property&&(this.seed=this.get_raw_value(e)),"pseudo"===e.type&&Nr(e.selector))for(let t of z(e.styles))"rule"===t.type&&"@seed"===t.property&&(this.seed=this.get_raw_value(t))})),_(this.seed)||e.update_random(this.seed)),(t||this.tokens).forEach((t=>{switch(t.type){case"rule":this.pre_compose_rule(t,e);break;case"pseudo":Nr(t.selector)&&(t.styles||[]).forEach((t=>{this.pre_compose_rule(t,e,t.selector)}))}}))}compose(e,t,r){this.coords.push(e),(t||this.tokens).forEach(((t,n)=>{if(t.skip)return!1;if(r&&this.grid)return!1;if("@gap"===t.property&&this.is_gap_set)return!1;if("@grid"===t.property&&this.is_grid_set)return!1;switch(t.type){case"rule":this.add_rule(this.compose_selector(e),this.compose_rule(t,e));break;case"pseudo":{t.selector.startsWith(":doodle")&&(t.selector=t.selector.replace(/^\:+doodle/,":host"));let r=Ar(t.selector);r&&(t.skip=!0),O(t.selector).forEach((n=>{let s=t.styles.map((t=>this.compose_rule(t,e,n))),i=r?n:this.compose_selector(e,n);this.add_rule(i,s)}));break}case"cond":{let r=t.name.substr(1),n=hr[r],s=[];if(n){let i=t.segments.find((e=>e.arguments));i&&i.arguments&&(s=i.arguments.map((t=>this.compose_argument(t,e))));let l=this.apply_func(n,e,s,r);t.segments&&t.segments[0]&&"not"===t.segments[0].keyword&&(l=!l),l&&(l.selector?t.styles.forEach((t=>{"rule"===t.type&&this.add_rule(l.selector.replaceAll("$",this.compose_selector(e)),this.compose_rule(t,e)),"pseudo"===t.type&&t.selector.split(",").forEach((r=>{let n=t.styles.map((t=>this.compose_rule(t,e,r)));this.add_rule((l.selector+r).replaceAll("$",this.compose_selector(e)),n)}))})):this.compose(e,t.styles))}else{let r=t.name+" "+t.segments.map((e=>e.keyword?e.keyword:Array.isArray(e.arguments)?"("+e.arguments[0][0].value+")":"")).join(" "),n="";t.styles.forEach((t=>{"rule"===t.type&&(n+=`${r}{${this.compose_rule(t,e)}}`),"pseudo"===t.type&&t.name.split(",").forEach((r=>{let s=t.styles.map((t=>this.compose_rule(t,e,r)));n+=`${(cond.selector+r).replaceAll("$",this.compose_selector(e))}{${s}}`}))})),this.add_rule(this.compose_selector(e),n)}break}case"keyframes":this.keyframes[t.name]||(this.keyframes[t.name]=e=>`\n ${C(t.steps.map((t=>`\n ${this.get_composed_value(t.name,e).value}{${C(t.styles.map((t=>this.compose_rule(t,e))))}}`)))}`)}}))}output(){for(let[e,t]of Object.entries(this.rules))if(Er(e)){let r=e.replace(/^:container\(?/,"grid").replace(/\)?$/,"");this.styles.container+=`${r}{${C(t)}}`}else{let r=Nr(e)?"host":"cells",n=C(t).trim();if(n.length){let t="host"===r?`${e},.host`:e;this.styles[r]+=`${t}{${n}}`}}if(this.uniforms.time){let e="animation-name",t=Nt.ticks,r=Nt.name,n=Et.name;this.styles.container+=`\n:host,.host{animation:${Nt.animation()},${Et.animation(jr+"ms")};}`,this.styles.keyframes+=`\n @keyframes ${Nt[e]}{from{--${r}:0} to{--${r}:${t}}} @keyframes ${Et[e]}{from{--${n}:0} to{--${n}:${t}}}`}this.coords.forEach(((e,t)=>{for(let[r,n]of Object.entries(this.keyframes)){let s=this.compose_aname(r,e.count);this.styles.keyframes+=`\n ${0===t?`@keyframes ${r}{${n(e)}}`:""} @keyframes ${s}{${n(e)}}`}}));let{keyframes:e,host:t,container:r,cells:n}=this.styles,s=e+t+r;return{props:this.props,styles:{main:s,cells:n,all:s+n},grid:this.grid,seed:this.seed,random:this.random,doodles:this.doodles,shaders:this.shaders,pattern:this.pattern,uniforms:this.uniforms,content:this.content}}};function Pr(e,t,r,n,s,i=[]){let l=new Rr(e),a=s||Sr(String(r)),o={};function u(e=0,t=1){return 1==arguments.length&&([e,t]=[0,e]),R(a(),e,t)}function c(...e){let t=e.reduce(((e,t)=>e.concat(t)),[]);return t[~~(a()*t.length)]}function h(e){let t=[...e],r=e.length;for(;r;){let e=~~(a()*r--),n=t[r];t[r]=t[e],t[e]=n}return t}l.pre_compose({x:1,y:1,z:1,count:1,context:{},grid:{x:1,y:1,z:1,count:1},random:a,rand:u,pick:c,shuffle:h,max_grid:n,update_random:function(e){a=Sr(String(e))},seed_value:r,rules:l,upextra:i});let{grid:p,seed:f}=l.output();if(p&&(t=p),f?(f=String(f),a=Sr(f)):f=r,_(f)&&(f=Date.now(),a=Sr(f)),f=String(f),l.seed=f,l.random=a,l.reset(),1==t.z)for(let e=1,r=0;e<=t.y;++e)for(let s=1;s<=t.x;++s)l.compose({x:s,y:e,z:1,count:++r,grid:t,context:o,rand:u,pick:c,shuffle:h,random:a,seed:f,max_grid:n,upextra:i,rules:l});else for(let e=1,r=0;e<=t.z;++e)l.compose({x:1,y:1,z:e,count:++r,grid:t,context:o,rand:u,pick:c,shuffle:h,random:a,seed:f,max_grid:n,rules:l,upextra:i});return l.output()}function zr(e,t,r){let n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}function Cr(e,t){return e.includes(t)?e:t+"\n"+e}function Mr(e,t){let r=tt.get(e);if(r)return Promise.resolve(r);let n=document.createElement("canvas"),s=devicePixelRatio||1,i=n.width=e.width*s,l=n.height=e.height*s,a=[],o=n.getContext("webgl2",{preserveDrawingBuffer:!0});if(!o)return Promise.resolve("");let u=Cr(e.fragment||"","uniform vec2 u_resolution;");u=Cr(u,"uniform float u_time;"),u=Cr(u,"uniform float u_timeDelta;"),u=Cr(u,"uniform int u_frameIndex;"),u=Cr(u,"uniform vec2 u_seed;"),e.textures.forEach((e=>{let t=`uniform sampler2D ${e.name};`;u=Cr(u,t)}));const c=/(^|[^\w\_])void\s+mainImage\(\s*out\s+vec4\s+fragColor,\s*in\s+vec2\s+fragCoord\s*\)/gm.test(u),h=["#define iResolution vec3(u_resolution, 0)","#define iTime u_time","#define iTimeDelta u_timeDelta","#define iFrame u_frameIndex",...e.textures.map(((e,t)=>`#define iChannel${t} ${e.name}`))].join("\n");c&&(u=`\n${h}\n${u}\nvoid main(){mainImage(FragColor, gl_FragCoord.xy);}`);let p=function(e,t,r){let n=zr(e,e.VERTEX_SHADER,t),s=zr(e,e.FRAGMENT_SHADER,r),i=e.createProgram();return e.attachShader(i,n),e.attachShader(i,s),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)||(console.warn("Link failed:"+e.getProgramInfoLog(i)),console.warn("vs info-log:"+e.getShaderInfoLog(n)),console.warn("fs info-log:"+e.getShaderInfoLog(s))),i}(o,e.vertex||"#version 300 es\n in vec4 position;void main(){gl_Position = position;}","#version 300 es\n precision highp float;out vec4 FragColor;"+u),f=o.getAttribLocation(p,"position"),d=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,d);o.bufferData(o.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,1,-1,1,1,-1]),o.STATIC_DRAW),o.enableVertexAttribArray(f),o.vertexAttribPointer(f,2,o.FLOAT,!1,0,0),o.viewport(0,0,o.drawingBufferWidth,o.drawingBufferHeight),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.useProgram(p);const m=e=>o.getUniformLocation(p,e),g=m("u_resolution");o.uniform2fv(g,[i,l]),e.textures.forEach(((e,t)=>{a.push(function(e,t,r){const n=e.createTexture();return e.activeTexture(e["TEXTURE"+r]),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),n}(o,e.value,t)),o.uniform1i(o.getUniformLocation(p,e.name),t)}));const v=m("u_seed");v&&o.uniform2f(v,T(t)/1e16,Math.random());const y=m("u_time"),b=m("u_frameIndex"),x=m("u_timeDelta");if(y||x||b){let t=0,r=0;return Promise.resolve(tt.set(e,((i,l,u,c)=>(o.clear(o.COLOR_BUFFER_BIT),e.width===l&&e.height===u||(c.forEach(((e,t)=>{o.bindTexture(o.TEXTURE_2D,a[t]),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,e.value)})),e.width=l,e.height=u,n.width=l*s,n.height=u*s,o.viewport(0,0,n.width,n.height),o.uniform2fv(g,[n.width,n.height])),y&&o.uniform1f(y,i/1e3),b&&o.uniform1i(b,t++),x&&(o.uniform1f(x,(r-i)/1e3),r=i),o.drawArrays(o.TRIANGLES,0,6),n.toDataURL()))))}return o.drawArrays(o.TRIANGLES,0,6),Promise.resolve(tt.set(e,n.toDataURL()))}function Ir(e,t){let r=[];for(;e.next();){let{curr:t,next:n}=e.get(),s=!n||t.isSymbol(";")||n.isSymbol("}");if(r.push(t),s)break}return r.length&&(t.value=Wr(r)),t}function Or(e,t){let r=[],n=[],s=t&&t.type||"",i=[];for(;e.next();){let{prev:l,curr:a,next:o}=e.get(),u=!o||a.isSymbol("}");if("block"===s&&u){o||!r.length||a.isSymbol("}")||(r[r.length-1].value+=";"+a.value),t.value=r;break}if(a.isSymbol("{")&&n.length&&!i.length){let t=Lr(n);if(!t.length)continue;let s=Or(e,{type:"block",name:"unkown",value:[]});t.forEach((e=>{let t=Object.assign({},s,{name:e.name,args:e.args});r.push(t)})),n=[]}else if(a.isSymbol(":")&&n.length&&!i.length){let i=Wr(n);r.push(Ir(e,{type:"statement",name:i,value:""})),"block"==s&&(t.value=r),n=[]}else a.isSymbol(";")?r.length&&n.length&&(r[r.length-1].value+=";"+Wr(n),n=[]):(a.isSymbol("(")&&i.push(a),a.isSymbol(")")&&i.pop(),n.push(a))}return r.length&&"block"==s&&(t.value=r),s?t:r}function Wr(e){return e.filter(((t,r)=>!t.isSymbol(";")||r!==e.length-1)).map((e=>e.value)).join("")}function Lr(e){let t=n(e),r=[],s="",i=[],l=[],a=[];for(;t.next();){let{curr:e,next:n}=t.get();!s.length&&e.isWord()?s=e.value:e.isSymbol("(")?(a.length&&l.push(e.value),a.push(e)):e.isSymbol(")")?(a.pop(),a.length?l.push(e.value):l.length&&(i.push(l.join("")),l=[])):e.isSymbol(",")?a.length?(i.push(l.join("")),l=[]):(l.length&&(i.push(l.join("")),l=[]),s&&(r.push({name:s,args:i}),s="",i=[],l=[])):l.push(e.value)}return s&&r.push({name:s,args:i}),r.filter(((e,t,r)=>r.findIndex((t=>t.name===e.name&&e.args.join("")==t.args.join("")))===t))}var Dr=function(e){return Or(n(p(e)))};function Ur(e,t){if("fill"===e.name){let{r,g:n,b:s,a:i}=t.get_rgba_color(e.value);return{type:"statement",value:`\ncolor = vec4(${Br(r/255)}, ${Br(n/255)}, ${Br(s/255)}, ${Br(i)});`}}return"grid"==e.name?{type:"grid",value:e.value}:{type:"statement",value:""}}function Br(e){return String(e).includes(".")?e:e+".0"}function Xr(e,t){let r=Dr(e),n=[],s={x:1,y:1};return r.forEach((e=>{if("statement"===e.type){let r=Ur(e,t);"statement"==r.type&&n.push(r.value),"grid"===r.type&&(s=Re(r.value,1/0))}else"block"===e.type&&n.push(function(e,t){if("match"===e.name){let r=e.args[0],n=[];return e.value.forEach((e=>{let r=Ur(e,t);"statement"==r.type&&n.push(r.value)})),`\n if (${r}){${n.join("")}}`}return""}(e,t))})),function(e,{x:t,y:r}){return`\n vec3 mapping(vec2 uv, vec2 grid){vec2 _grid = 1.0/grid;float x = ceil(uv.x/_grid.x);float y = ceil(grid.y - uv.y/_grid.y);float i = x + (y - 1.0) * y;return vec3(x, y, i);} vec4 getColor(float x, float y, float i, float I, float X, float Y, float t){vec4 color = vec4(0, 0, 0, 0);${e} return color;} void main(){vec2 uv = gl_FragCoord.xy/u_resolution.xy;vec2 v = vec2(${t}, ${r});vec3 p = mapping(uv, v);FragColor = getColor(p.x, p.y, p.z, v.x * v.y, v.x, v.y, u_time);}`}(n.join(""),s)}function Fr(e,t,r,n){return new Promise(((s,i)=>{let l=`data:image/svg+xml;utf8,${encodeURIComponent(e)}`;function a(){let e=new Image;e.crossOrigin="anonymous",e.src=l,e.onload=()=>{let a=document.createElement("canvas"),o=a.getContext("2d"),u=devicePixelRatio||1;1!=n&&(u=1),a.width=t*u,a.height=r*u,o.drawImage(e,0,0,a.width,a.height);try{a.toBlob((e=>{s({blob:e,source:l,url:URL.createObjectURL(e)})}))}catch(e){i(e)}}}E()?N(l,a,200):a()}))}var qr=1e3/60;function Hr(e){if("undefined"==typeof getComputedStyle)return"";let t={};if(e.computedStyleMap)for(let[r,n]of e.computedStyleMap())r.startsWith("--")&&(t[r]=n[0][0]);else{let r=getComputedStyle(e);for(let e of r)e.startsWith("--")&&(t[e]=r.getPropertyValue(e))}return function(e){let t=[];for(let[r,n]of Object.entries(e))t.push(r+":"+n);return t.join(";")}(t)}var Yr={CSSDoodle:class{},define(e,t){"undefined"==typeof customElements||customElements.get(e)||customElements.define(e,t)}};function Vr(e){let{x:t,y:r}=e||{};return`\n *,*::after,*::before,:host,.host{box-sizing:border-box;}:host,.host{display:block;visibility:visible;width:auto;height:auto;contain:strict;view-transition-name:css-doodle;--${Nt.name}:0;--${Et.name}:0\n}:host([hidden]),[hidden]{display:none\n}:host([cssd-paused]),\n:host([cssd-paused]) *{animation-play-state:paused !important\n} grid, cell{display:grid;position:relative;} grid{gap:inherit;grid-template:repeat(${r},1fr)/repeat(${t},1fr);container-type:size\n} cell{place-items:center\n} svg{position:absolute;} grid, svg{width:100%;height:100%\n}`}function Gr(e,t,r,n,s=""){let i=S(e,t,r);return`<cell id="${i}">${n["#"+i]??""}${s??""}</cell>`}function Zr(e,t){let{x:r,y:n,z:s}=e||{},i="";if(1==s)for(let e=1;e<=n;++e)for(let n=1;n<=r;++n)i+=Gr(n,e,1,t);else{let e="";for(let r=s;r>=1;r--){e=Gr(1,1,r,t,e)}i=e}return`<grid>${i}</grid>`}"undefined"!=typeof HTMLElement&&(Yr.CSSDoodle=class extends HTMLElement{constructor(){super(),this.doodle=this.attachShadow({mode:"open"}),this.animations=[],this.extra={get_variable:e=>function(e,t){return"undefined"==typeof getComputedStyle?"":getComputedStyle(e).getPropertyValue(t).trim().replace(/^\(|\)$/g,"")}(this,e),get_rgba_color:e=>function(e,t){let r=e.querySelector("style");return r?(r.style.color=t,function(e){let[t,r,n,s=1]=e.replace(/rgba?\((.+)\)/,((e,t)=>t)).split(/,\s*/);return{r:t,g:r,b:n,a:s}}(getComputedStyle(r).color)):{r:0,g:0,b:0,a:1}}(this.shadowRoot,e)}}connectedCallback(e){this.innerHTML?this.load(e):setTimeout((()=>this.load(e)))}disconnectedCallback(){this.cleanup()}triggerEvent(e,t={}){return this.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))}_update(e){this.cleanup(),e||(e=A(this._code)),this._code!==e&&(this._code=e),this.grid_size||(this.grid_size=this.get_grid());const{x:t,y:r,z:n}=this.grid_size,s=this.get_use();let i="",l={};this.compiled&&(i=this.compiled.content,l=this.compiled.styles);const a=this.generate(Te(s+e,this.extra));let o=a.grid||this.get_grid(),{x:u,y:c,z:h}=o,p=!this.shadowRoot.innerHTML||this.shadowRoot.querySelector("css-doodle")||t!==u||r!==c||n!==h||JSON.stringify(i)!==JSON.stringify(a.content)||!l.cells||!a.styles.cells;if(Object.assign(this.grid_size,o),p)a.grid?this.build_grid(a,o):this.build_grid(this.generate(Te(s+e,this.extra)),o);else{this.bind_uniforms(a.uniforms);let e=this.replace(a);a.props.has_animation&&(this.set_style(l.all.replace(/animation/g,"x")),this.reflow()),this.set_style(e(Vr(this.grid_size)+a.styles.all))}setTimeout((()=>{this.triggerEvent("render"),this.triggerEvent("afterUpdate"),this.triggerEvent("update")}))}update(e,t={}){if(this.triggerEvent("beforeUpdate"),!document.startViewTransition)return this._update(e);arguments.length||(e=""),"object"==typeof e&&(e="");let r=this.viewTransition;void 0===r&&(r=this.hasAttribute("view-transition")),r?document.startViewTransition((()=>{this._update(e)})):this._update(e)}pause(){this.setAttribute("cssd-paused",!0);for(let e of this.animations)e.pause()}resume(){this.removeAttribute("cssd-paused");for(let e of this.animations)e.resume()}export({scale:e,name:t,download:r,detail:n}={}){return new Promise(((s,i)=>{let l=Hr(this),a=this.doodle.innerHTML,{width:o,height:u}=this.getBoundingClientRect(),c=o*(e=parseInt(e)||1),h=u*e,p=`\n<svg ${Le} preserveAspectRatio="none"\n viewBox="0 0 ${o} ${u}"\n ${E()?"":`width="${c}px" height="${h}px"`}><foreignObject width="100%" height="100%"><div class="host" ${De} style="width:${o}px;height:${u}px"><style>.host{${f=l,f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}}</style>${a}</div></foreignObject></svg>`;var f;r||n?Fr(p,c,h,e).then((({source:e,url:n,blob:i})=>{if(s({width:c,height:h,svg:p,blob:i,source:e}),r){let e=document.createElement("a");e.download=function(e){return(_(e)?Date.now():String(e).replace(/\/.png$/g,""))+".png"}(t),e.href=n,e.click()}})).catch((e=>{i(e)})):s({width:c,height:h,svg:p})}))}get grid(){return Object.assign({},this.grid_size)}set grid(e){this.attr("grid",e),this.connectedCallback(!0)}get seed(){return this._seed_value}set seed(e){this.attr("seed",e),this.connectedCallback(!0)}get use(){return this.attr("use")}set use(e){this.attr("use",e),this.connectedCallback(!0)}get_max_grid(){return this.hasAttribute("experimental")?256:64}get_grid(){return Re(this.attr("grid"),this.get_max_grid())}get_use(){let e=String(this.attr("use")||"").trim();return/^var\(/.test(e)&&(e=`@use:${e};`),e}cleanup(){if(tt.clear(),this.compiled){for(let e of this.animations)e.cancel();this.animations=[];let{pattern:e,shaders:t}=this.compiled;if(Object.keys(e).length||Object.keys(t).length)for(let e of this.shadowRoot.querySelectorAll("cell"))e.style.cssText=""}}attr(e,t){let r=arguments.length;return 1===r?this.getAttribute(e):2===r?(this.setAttribute(e,t),t):void 0}generate(e){let t=this.get_grid(),r=this.attr("seed")||this.attr("data-seed");_(r)&&(r=Date.now());let n=this.compiled=Pr(e,t,r,this.get_max_grid());return this._seed_value=n.seed,this._seed_random=n.random,n}doodle_to_image(e,t,r){"function"==typeof t&&(r=t,t=null);let n=Te(e=":doodle{width:100%;height:100%}"+e,this.extra),s=Re(""),i=Pr(n,s,this._seed_value,this.get_max_grid(),this._seed_random,t.upextra),l=i.grid?i.grid:s,a="";if(t&&t.arg){let e=Re(t.arg,1/0);e.x&&e.y&&(t.width=e.x+"px",t.height=e.y+"px",a=`viewBox="0 0 ${e.x} ${e.y}"`)}let o=this.replace(i),u=Zr(l,i.content),c=t&&t.width&&t.height?`width="${t.width}" height="${t.height}"`:"";o(`\n<svg ${c} ${Le} preserveAspectRatio="none" ${a}><foreignObject width="100%" height="100%"><div class="host" width="100%" height="100%" ${De}><style>@property --${Nt.name}{syntax:"&lt;integer&gt;";initial-value:0;inherits:true;} @property --${Et.name}{syntax:"&lt;integer&gt;";initial-value:0;inherits:true;} ${Vr(l)} ${i.styles.all}</style>${u}</div></foreignObject></svg>`).then((e=>{let n=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(e)))}`;E()?c?Fr(e,parseInt(t.width),parseInt(t.height),devicePixelRatio||2).then((({blob:e})=>{let t=URL.createObjectURL(e);N(t),r(t)})):(N(n),r(n)):r(n)}))}pattern_to_image({code:e,cell:t,id:r},n){let s=Xr(e,this.extra);this.shader_to_image({shader:s,cell:t,id:r},n)}shader_to_image({shader:e,cell:t,id:r},n){const s=this.doodle.getElementById(t);if(!s)return!1;let{width:i,height:l}=s.getBoundingClientRect(),a=devicePixelRatio||1,o=this.seed,u="string"==typeof e?Ie(e):e;u.width=i,u.height=l;let c=u.textures,h=[];const p=e=>{s.style.setProperty(r,`url(${e})`)},f=e=>{"function"==typeof e?this.animations.push(function(e){let t,r=0,n=0,s=0,i=!1;function l(i){r||(r=i),e(r);let a=i-n;a<qr&&(a=qr),a>1e3&&(a=s||1e3),n&&(r+=a),s=a,n=i,t=requestAnimationFrame(l)}return t=requestAnimationFrame(l),{resume(){t&&i&&(i=!1,t=requestAnimationFrame(l))},pause(){t&&(cancelAnimationFrame(t),i=!0)},cancel(){t&&(i=!1,cancelAnimationFrame(t),t=null)}}}((t=>{p(e(t,i,l,h))}))):p(e)},d=(e,t)=>{Promise.all(e.map((({name:e,value:t})=>new Promise((r=>{this.doodle_to_image(t,{width:i,height:l},(t=>{let n=new Image;n.width=i*a,n.height=i*a,n.onload=()=>r({name:e,value:n}),n.src=t}))}))))).then(t)};s.observer||(s.observer=new ResizeObserver((()=>{let e=s.getBoundingClientRect();i=e.width,l=e.height,d(c,(e=>h=e))})),s.observer.observe(s)),c.length?d(c,(e=>{u.textures=h=e,u.width=i,u.height=l,Mr(u,o).then(f).then(n)})):Mr(u,o).then(f).then(n)}load(e){this.cleanup();let t=this._code||this.innerHTML,r=Te(this.get_use()+A(t),this.extra),n=this.generate(r);e||this.hasAttribute("click-to-update")&&this.addEventListener("click",(e=>this.update())),this.grid_size=n.grid?n.grid:this.get_grid(),this.build_grid(n,this.grid_size),this._code=t,this.innerHTML="",setTimeout((()=>{this.triggerEvent("render")}))}replace({doodles:e,shaders:t,pattern:r}){let n=Object.keys(e),s=Object.keys(t),i=Object.keys(r),l=n.length+s.length+i.length;return a=>{if(!l)return Promise.resolve(a);let o=[].concat(n.map((t=>a.includes(t)?new Promise((r=>{let{arg:n,doodle:s,upextra:i}=e[t];this.doodle_to_image(s,{arg:n,upextra:i},(e=>r({id:t,value:e})))})):Promise.resolve(""))),s.map((e=>a.includes(e)?new Promise((r=>{this.shader_to_image(t[e],(t=>r({id:e,value:t})))})):Promise.resolve(""))),i.map((e=>a.includes(e)?new Promise((t=>{this.pattern_to_image(r[e],(r=>t({id:e,value:r})))})):Promise.resolve(""))));return Promise.all(o).then((e=>{for(let{id:t,value:r}of e){let e=`url(${r})`;/^shader|^pattern/.test(t)&&(e=`var(--${t})`),a=a.replaceAll("${"+t+"}",e)}return a}))}}reflow(){this.shadowRoot.querySelector("grid").offsetWidth}bind_uniforms({time:e,mousex:t,mousey:r,width:n,height:s}){e&&this.reg_utime(),t||r?this.reg_umouse(t,r):this.off_umouse(),n||s?this.reg_usize(n,s):this.off_usize()}build_grid(e,t){const{has_transition:r,has_animation:n}=e.props;let s=r||n;const{uniforms:i,content:l,styles:a}=e;console.log(a),this.doodle.innerHTML=`\n<style>${Vr(t)+a.main}</style>${a.cells?Zr(t,l):""}`,s&&this.reflow();let o=this.replace(e);this.set_style(o(Vr(t)+a.all)),this.bind_uniforms(i)}reg_umouse(e,t){if(this.umouse_fn)e||t||this.off_umouse();else{this.umouse_fn=r=>{let n=r.detail||r;(e||t)&&(this.style.setProperty("--"+At,n.offsetX),this.style.setProperty("--"+Tt,n.offsetY))},this.addEventListener("pointermove",this.umouse_fn);let r=new CustomEvent("pointermove",{detail:{offsetX:0,offsetY:0}});this.dispatchEvent(r)}}off_umouse(){this.umouse_fn&&(this.style.removeProperty("--"+At),this.style.removeProperty("--"+Tt),this.removeEventListener("pointermove",this.umouse_fn),this.umouse_fn=null)}reg_usize(e,t){this.usize_observer?e||t||this.off_usize():(this.usize_observer=new ResizeObserver((()=>{let r=this.getBoundingClientRect();(e||t)&&(this.style.setProperty("--"+Rt,r.width),this.style.setProperty("--"+Pt,r.height))})),this.usize_observer.observe(this))}off_usize(){this.usize_observer&&(this.style.removeProperty("--"+Rt),this.style.removeProperty("--"+Pt),this.usize_observer.unobserve(this),this.usize_observer=null)}reg_utime(){if(!this.is_utime_set){try{CSS.registerProperty({name:"--"+Nt.name,syntax:"<integer>",initialValue:0,inherits:!0}),CSS.registerProperty({name:"--"+Et.name,syntax:"<integer>",initialValue:0,inherits:!0})}catch(e){}this.is_utime_set=!0}}set_style(e){if(e instanceof Promise)e.then((e=>{this.set_style(e)}));else{const t=this.shadowRoot.querySelector("style");t&&(t.textContent=e.replace(/\n\s+/g," "))}}});var Kr=Yr.CSSDoodle;(0,Yr.define)("css-doodle",Kr)})();